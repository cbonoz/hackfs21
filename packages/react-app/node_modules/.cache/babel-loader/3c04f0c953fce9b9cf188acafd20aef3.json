{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n};\n\nimport { parse } from 'graphql';\nimport React from 'react';\nimport QueryStore from '../utility/QueryStore';\nimport HistoryQuery from './HistoryQuery';\nvar MAX_QUERY_SIZE = 100000;\nvar MAX_HISTORY_LENGTH = 20;\n\nvar shouldSaveQuery = function (query, variables, headers, lastQuerySaved) {\n  if (!query) {\n    return false;\n  }\n\n  try {\n    parse(query);\n  } catch (e) {\n    return false;\n  }\n\n  if (query.length > MAX_QUERY_SIZE) {\n    return false;\n  }\n\n  if (!lastQuerySaved) {\n    return true;\n  }\n\n  if (JSON.stringify(query) === JSON.stringify(lastQuerySaved.query)) {\n    if (JSON.stringify(variables) === JSON.stringify(lastQuerySaved.variables)) {\n      if (JSON.stringify(headers) === JSON.stringify(lastQuerySaved.headers)) {\n        return false;\n      }\n\n      if (headers && !lastQuerySaved.headers) {\n        return false;\n      }\n    }\n\n    if (variables && !lastQuerySaved.variables) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\nvar QueryHistory = function (_super) {\n  __extends(QueryHistory, _super);\n\n  function QueryHistory(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.updateHistory = function (query, variables, headers, operationName) {\n      if (shouldSaveQuery(query, variables, headers, _this.historyStore.fetchRecent())) {\n        _this.historyStore.push({\n          query: query,\n          variables: variables,\n          headers: headers,\n          operationName: operationName\n        });\n\n        var historyQueries = _this.historyStore.items;\n        var favoriteQueries = _this.favoriteStore.items;\n        var queries = historyQueries.concat(favoriteQueries);\n\n        _this.setState({\n          queries: queries\n        });\n      }\n    };\n\n    _this.toggleFavorite = function (query, variables, headers, operationName, label, favorite) {\n      var item = {\n        query: query,\n        variables: variables,\n        headers: headers,\n        operationName: operationName,\n        label: label\n      };\n\n      if (!_this.favoriteStore.contains(item)) {\n        item.favorite = true;\n\n        _this.favoriteStore.push(item);\n      } else if (favorite) {\n        item.favorite = false;\n\n        _this.favoriteStore.delete(item);\n      }\n\n      _this.setState({\n        queries: __spread(_this.historyStore.items, _this.favoriteStore.items)\n      });\n    };\n\n    _this.editLabel = function (query, variables, headers, operationName, label, favorite) {\n      var item = {\n        query: query,\n        variables: variables,\n        headers: headers,\n        operationName: operationName,\n        label: label\n      };\n\n      if (favorite) {\n        _this.favoriteStore.edit(__assign(__assign({}, item), {\n          favorite: favorite\n        }));\n      } else {\n        _this.historyStore.edit(item);\n      }\n\n      _this.setState({\n        queries: __spread(_this.historyStore.items, _this.favoriteStore.items)\n      });\n    };\n\n    _this.historyStore = new QueryStore('queries', props.storage, MAX_HISTORY_LENGTH);\n    _this.favoriteStore = new QueryStore('favorites', props.storage, null);\n\n    var historyQueries = _this.historyStore.fetchAll();\n\n    var favoriteQueries = _this.favoriteStore.fetchAll();\n\n    var queries = historyQueries.concat(favoriteQueries);\n    _this.state = {\n      queries: queries\n    };\n    return _this;\n  }\n\n  QueryHistory.prototype.render = function () {\n    var _this = this;\n\n    var queries = this.state.queries.slice().reverse();\n    var queryNodes = queries.map(function (query, i) {\n      return React.createElement(HistoryQuery, __assign({\n        handleEditLabel: _this.editLabel,\n        handleToggleFavorite: _this.toggleFavorite,\n        key: i + \":\" + (query.label || query.query),\n        onSelect: _this.props.onSelectQuery\n      }, query));\n    });\n    return React.createElement(\"section\", {\n      \"aria-label\": \"History\"\n    }, React.createElement(\"div\", {\n      className: \"history-title-bar\"\n    }, React.createElement(\"div\", {\n      className: \"history-title\"\n    }, 'History'), React.createElement(\"div\", {\n      className: \"doc-explorer-rhs\"\n    }, this.props.children)), React.createElement(\"ul\", {\n      className: \"history-contents\"\n    }, queryNodes));\n  };\n\n  return QueryHistory;\n}(React.Component);\n\nexport { QueryHistory };","map":{"version":3,"sources":["../../src/components/QueryHistory.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport { parse } from 'graphql';\nimport React from 'react';\nimport QueryStore from '../utility/QueryStore';\nimport HistoryQuery from './HistoryQuery';\nvar MAX_QUERY_SIZE = 100000;\nvar MAX_HISTORY_LENGTH = 20;\nvar shouldSaveQuery = function (query, variables, headers, lastQuerySaved) {\n    if (!query) {\n        return false;\n    }\n    try {\n        parse(query);\n    }\n    catch (e) {\n        return false;\n    }\n    if (query.length > MAX_QUERY_SIZE) {\n        return false;\n    }\n    if (!lastQuerySaved) {\n        return true;\n    }\n    if (JSON.stringify(query) === JSON.stringify(lastQuerySaved.query)) {\n        if (JSON.stringify(variables) === JSON.stringify(lastQuerySaved.variables)) {\n            if (JSON.stringify(headers) === JSON.stringify(lastQuerySaved.headers)) {\n                return false;\n            }\n            if (headers && !lastQuerySaved.headers) {\n                return false;\n            }\n        }\n        if (variables && !lastQuerySaved.variables) {\n            return false;\n        }\n    }\n    return true;\n};\nvar QueryHistory = (function (_super) {\n    __extends(QueryHistory, _super);\n    function QueryHistory(props) {\n        var _this = _super.call(this, props) || this;\n        _this.updateHistory = function (query, variables, headers, operationName) {\n            if (shouldSaveQuery(query, variables, headers, _this.historyStore.fetchRecent())) {\n                _this.historyStore.push({\n                    query: query,\n                    variables: variables,\n                    headers: headers,\n                    operationName: operationName,\n                });\n                var historyQueries = _this.historyStore.items;\n                var favoriteQueries = _this.favoriteStore.items;\n                var queries = historyQueries.concat(favoriteQueries);\n                _this.setState({\n                    queries: queries,\n                });\n            }\n        };\n        _this.toggleFavorite = function (query, variables, headers, operationName, label, favorite) {\n            var item = {\n                query: query,\n                variables: variables,\n                headers: headers,\n                operationName: operationName,\n                label: label,\n            };\n            if (!_this.favoriteStore.contains(item)) {\n                item.favorite = true;\n                _this.favoriteStore.push(item);\n            }\n            else if (favorite) {\n                item.favorite = false;\n                _this.favoriteStore.delete(item);\n            }\n            _this.setState({\n                queries: __spread(_this.historyStore.items, _this.favoriteStore.items),\n            });\n        };\n        _this.editLabel = function (query, variables, headers, operationName, label, favorite) {\n            var item = {\n                query: query,\n                variables: variables,\n                headers: headers,\n                operationName: operationName,\n                label: label,\n            };\n            if (favorite) {\n                _this.favoriteStore.edit(__assign(__assign({}, item), { favorite: favorite }));\n            }\n            else {\n                _this.historyStore.edit(item);\n            }\n            _this.setState({\n                queries: __spread(_this.historyStore.items, _this.favoriteStore.items),\n            });\n        };\n        _this.historyStore = new QueryStore('queries', props.storage, MAX_HISTORY_LENGTH);\n        _this.favoriteStore = new QueryStore('favorites', props.storage, null);\n        var historyQueries = _this.historyStore.fetchAll();\n        var favoriteQueries = _this.favoriteStore.fetchAll();\n        var queries = historyQueries.concat(favoriteQueries);\n        _this.state = { queries: queries };\n        return _this;\n    }\n    QueryHistory.prototype.render = function () {\n        var _this = this;\n        var queries = this.state.queries.slice().reverse();\n        var queryNodes = queries.map(function (query, i) {\n            return (React.createElement(HistoryQuery, __assign({ handleEditLabel: _this.editLabel, handleToggleFavorite: _this.toggleFavorite, key: i + \":\" + (query.label || query.query), onSelect: _this.props.onSelectQuery }, query)));\n        });\n        return (React.createElement(\"section\", { \"aria-label\": \"History\" },\n            React.createElement(\"div\", { className: \"history-title-bar\" },\n                React.createElement(\"div\", { className: \"history-title\" }, 'History'),\n                React.createElement(\"div\", { className: \"doc-explorer-rhs\" }, this.props.children)),\n            React.createElement(\"ul\", { className: \"history-contents\" }, queryNodes)));\n    };\n    return QueryHistory;\n}(React.Component));\nexport { QueryHistory };\n//# sourceMappingURL=QueryHistory.js.map"]},"metadata":{},"sourceType":"module"}