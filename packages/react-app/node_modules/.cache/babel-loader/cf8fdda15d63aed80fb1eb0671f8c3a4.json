{"ast":null,"code":"import SturdyWebSocket from 'sturdy-websocket';\nimport CryptoEs from 'crypto-es';\nconst networks = {\n  bitcoin: {\n    '1': 'main',\n    '2': 'testnet'\n  },\n  ethereum: {\n    '1': 'main',\n    '3': 'ropsten',\n    '4': 'rinkeby',\n    '5': 'goerli',\n    '42': 'kovan',\n    '56': 'bsc-main',\n    '100': 'xdai'\n  }\n};\nconst DEFAULT_RATE_LIMIT_RULES = {\n  points: 150,\n  duration: 1\n};\nconst QUEUE_LIMIT = 10000;\n\nfunction createEmitter() {\n  return {\n    listeners: {},\n    on: function (eventCode, listener) {\n      // check if valid eventCode\n      switch (eventCode) {\n        case 'txSent':\n        case 'txPool':\n        case 'txConfirmed':\n        case 'txSpeedUp':\n        case 'txCancel':\n        case 'txFailed':\n        case 'txDropped':\n        case 'txRequest':\n        case 'nsfFail':\n        case 'txRepeat':\n        case 'txAwaitingApproval':\n        case 'txConfirmReminder':\n        case 'txSendFail':\n        case 'txError':\n        case 'txUnderPriced':\n        case 'txPoolSimulation':\n        case 'all':\n          break;\n\n        default:\n          throw new Error(`${eventCode} is not a valid event code, for a list of valid event codes see: https://docs.blocknative.com/notify-sdk#event-codes`);\n      } // check that listener is a function\n\n\n      if (typeof listener !== 'function') {\n        throw new Error('Listener must be a function');\n      } // add listener for the eventCode\n\n\n      this.listeners[eventCode] = listener;\n    },\n    off: function (eventCode) {\n      delete this.listeners[eventCode];\n    },\n    emit: function (state) {\n      if (this.listeners[state.eventCode]) {\n        return this.listeners[state.eventCode](state);\n      }\n\n      if (this.listeners.all) {\n        return this.listeners.all(state);\n      }\n    }\n  };\n}\n\nfunction networkName(blockchain, id) {\n  return networks[blockchain][id];\n}\n\nfunction serverEcho(eventCode) {\n  switch (eventCode) {\n    case 'txRequest':\n    case 'nsfFail':\n    case 'txRepeat':\n    case 'txAwaitingApproval':\n    case 'txConfirmReminder':\n    case 'txSendFail':\n    case 'txError':\n    case 'txUnderPriced':\n    case 'txSent':\n      return true;\n\n    default:\n      return false;\n  }\n}\n\nfunction last(arr) {\n  return arr.reverse()[0];\n} // isAddress and isTxid are not meant to perform real validation,\n// just needs to work out if it is an address or a transaction id\n// the server will do more thorough validation\n\n\nfunction isAddress(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 42;\n\n    case 'bitcoin':\n      return addressOrHash.length !== 64;\n\n    default:\n      return false;\n  }\n}\n\nfunction isTxid(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 66;\n\n    case 'bitcoin':\n      return addressOrHash.length === 64;\n\n    default:\n      return false;\n  }\n}\n\nfunction wait(time) {\n  return new Promise(resolve => {\n    setTimeout(resolve, time);\n  });\n}\n\nconst jsonPreserveUndefined = (k, v) => v === undefined ? 'undefined' : v;\n\nfunction transaction(hash, id) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // create startTime for transaction\n\n  const startTime = Date.now(); // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'txSent'; // put in queue\n\n  this._watchedTransactions.push({\n    hash,\n    emitter\n  });\n\n  const transaction = {\n    [this._system === 'ethereum' ? 'hash' : 'txid']: hash,\n    id: id || hash,\n    startTime,\n    status: 'sent'\n  };\n  const newState = { ...transaction,\n    eventCode\n  }; // logEvent to server\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'activeTransaction',\n    transaction\n  });\n\n  const transactionObj = {\n    details: newState,\n    emitter\n  };\n\n  function emitState() {\n    const emitterResult = emitter.emit(newState);\n\n    this._transactionHandlers.forEach(handler => handler({\n      transaction: newState,\n      emitterResult\n    }));\n  } // emit after delay to allow for listener to be registered\n\n\n  setTimeout(emitState.bind(this), 5);\n  return transactionObj;\n}\n\nfunction account(address) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // lowercase the address if Ethereum\n\n  address = this._system === 'ethereum' ? address.toLowerCase() : address; // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'watch';\n\n  const existingAddressWatcher = this._watchedAccounts.find(ac => ac.address === address);\n\n  if (existingAddressWatcher) {\n    // add to existing emitters array\n    existingAddressWatcher.emitters.push(emitter);\n  } else {\n    // put in accounts queue\n    this._watchedAccounts.push({\n      address,\n      emitters: [emitter]\n    });\n  } // logEvent to server\n\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'accountAddress',\n    account: {\n      address\n    }\n  });\n\n  return {\n    emitter,\n    details: {\n      address\n    }\n  };\n}\n\nfunction event(eventObj) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n\n  this._sendMessage(eventObj);\n}\n\nfunction unsubscribe(addressOrHash) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const address = isAddress(this._system, addressOrHash);\n  const txid = isTxid(this._system, addressOrHash); // check if it is an address or a hash\n\n  if (address) {\n    const normalizedAddress = this._system === 'ethereum' ? addressOrHash.toLowerCase() : addressOrHash; // remove address from accounts\n\n    this._watchedAccounts = this._watchedAccounts.filter(ac => ac.address !== normalizedAddress); // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'accountAddress',\n      eventCode: 'unwatch',\n      account: {\n        address: normalizedAddress\n      }\n    });\n  } else if (txid) {\n    // remove transaction from transactions\n    this._watchedTransactions = this._watchedTransactions.filter(tx => tx.hash !== addressOrHash); // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'activeTransaction',\n      eventCode: 'unwatch',\n      transaction: {\n        [this._system === 'ethereum' ? 'hash' : 'txid']: addressOrHash,\n        id: addressOrHash,\n        status: 'unsubscribed'\n      }\n    });\n  } else {\n    throw new Error(`Error trying to unsubscribe ${addressOrHash}: not a valid address or transaction id/hash`);\n  }\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nvar config = {\n  Promise: undefined,\n\n  set useDeprecatedSynchronousErrorHandling(value) {\n    if (value) {\n      var error = /*@__PURE__*/new Error();\n      /*@__PURE__*/\n\n      console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n    }\n\n    _enable_super_gross_mode_that_will_cause_bad_things = value;\n  },\n\n  get useDeprecatedSynchronousErrorHandling() {\n    return _enable_super_gross_mode_that_will_cause_bad_things;\n  }\n\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction hostReportError(err) {\n  setTimeout(function () {\n    throw err;\n  }, 0);\n}\n/** PURE_IMPORTS_START _config,_util_hostReportError PURE_IMPORTS_END */\n\n\nvar empty = {\n  closed: true,\n  next: function (value) {},\n  error: function (err) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      throw err;\n    } else {\n      hostReportError(err);\n    }\n  },\n  complete: function () {}\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar isArray = /*@__PURE__*/function () {\n  return Array.isArray || function (x) {\n    return x && typeof x.length === 'number';\n  };\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isObject(x) {\n  return x !== null && typeof x === 'object';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar UnsubscriptionErrorImpl = /*@__PURE__*/function () {\n  function UnsubscriptionErrorImpl(errors) {\n    Error.call(this);\n    this.message = errors ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) {\n      return i + 1 + \") \" + err.toString();\n    }).join('\\n  ') : '';\n    this.name = 'UnsubscriptionError';\n    this.errors = errors;\n    return this;\n  }\n\n  UnsubscriptionErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return UnsubscriptionErrorImpl;\n}();\n\nvar UnsubscriptionError = UnsubscriptionErrorImpl;\n/** PURE_IMPORTS_START _util_isArray,_util_isObject,_util_isFunction,_util_UnsubscriptionError PURE_IMPORTS_END */\n\nvar Subscription = /*@__PURE__*/function () {\n  function Subscription(unsubscribe) {\n    this.closed = false;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n\n    if (unsubscribe) {\n      this._ctorUnsubscribe = true;\n      this._unsubscribe = unsubscribe;\n    }\n  }\n\n  Subscription.prototype.unsubscribe = function () {\n    var errors;\n\n    if (this.closed) {\n      return;\n    }\n\n    var _a = this,\n        _parentOrParents = _a._parentOrParents,\n        _ctorUnsubscribe = _a._ctorUnsubscribe,\n        _unsubscribe = _a._unsubscribe,\n        _subscriptions = _a._subscriptions;\n\n    this.closed = true;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n\n    if (_parentOrParents instanceof Subscription) {\n      _parentOrParents.remove(this);\n    } else if (_parentOrParents !== null) {\n      for (var index = 0; index < _parentOrParents.length; ++index) {\n        var parent_1 = _parentOrParents[index];\n        parent_1.remove(this);\n      }\n    }\n\n    if (isFunction(_unsubscribe)) {\n      if (_ctorUnsubscribe) {\n        this._unsubscribe = undefined;\n      }\n\n      try {\n        _unsubscribe.call(this);\n      } catch (e) {\n        errors = e instanceof UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n      }\n    }\n\n    if (isArray(_subscriptions)) {\n      var index = -1;\n      var len = _subscriptions.length;\n\n      while (++index < len) {\n        var sub = _subscriptions[index];\n\n        if (isObject(sub)) {\n          try {\n            sub.unsubscribe();\n          } catch (e) {\n            errors = errors || [];\n\n            if (e instanceof UnsubscriptionError) {\n              errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n            } else {\n              errors.push(e);\n            }\n          }\n        }\n      }\n    }\n\n    if (errors) {\n      throw new UnsubscriptionError(errors);\n    }\n  };\n\n  Subscription.prototype.add = function (teardown) {\n    var subscription = teardown;\n\n    if (!teardown) {\n      return Subscription.EMPTY;\n    }\n\n    switch (typeof teardown) {\n      case 'function':\n        subscription = new Subscription(teardown);\n\n      case 'object':\n        if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n          return subscription;\n        } else if (this.closed) {\n          subscription.unsubscribe();\n          return subscription;\n        } else if (!(subscription instanceof Subscription)) {\n          var tmp = subscription;\n          subscription = new Subscription();\n          subscription._subscriptions = [tmp];\n        }\n\n        break;\n\n      default:\n        {\n          throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n        }\n    }\n\n    var _parentOrParents = subscription._parentOrParents;\n\n    if (_parentOrParents === null) {\n      subscription._parentOrParents = this;\n    } else if (_parentOrParents instanceof Subscription) {\n      if (_parentOrParents === this) {\n        return subscription;\n      }\n\n      subscription._parentOrParents = [_parentOrParents, this];\n    } else if (_parentOrParents.indexOf(this) === -1) {\n      _parentOrParents.push(this);\n    } else {\n      return subscription;\n    }\n\n    var subscriptions = this._subscriptions;\n\n    if (subscriptions === null) {\n      this._subscriptions = [subscription];\n    } else {\n      subscriptions.push(subscription);\n    }\n\n    return subscription;\n  };\n\n  Subscription.prototype.remove = function (subscription) {\n    var subscriptions = this._subscriptions;\n\n    if (subscriptions) {\n      var subscriptionIndex = subscriptions.indexOf(subscription);\n\n      if (subscriptionIndex !== -1) {\n        subscriptions.splice(subscriptionIndex, 1);\n      }\n    }\n  };\n\n  Subscription.EMPTY = function (empty) {\n    empty.closed = true;\n    return empty;\n  }(new Subscription());\n\n  return Subscription;\n}();\n\nfunction flattenUnsubscriptionErrors(errors) {\n  return errors.reduce(function (errs, err) {\n    return errs.concat(err instanceof UnsubscriptionError ? err.errors : err);\n  }, []);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar rxSubscriber = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' ? /*@__PURE__*/Symbol('rxSubscriber') : '@@rxSubscriber_' + /*@__PURE__*/Math.random();\n}();\n/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */\n\n\nvar Subscriber = /*@__PURE__*/function (_super) {\n  __extends(Subscriber, _super);\n\n  function Subscriber(destinationOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n\n    _this.syncErrorValue = null;\n    _this.syncErrorThrown = false;\n    _this.syncErrorThrowable = false;\n    _this.isStopped = false;\n\n    switch (arguments.length) {\n      case 0:\n        _this.destination = empty;\n        break;\n\n      case 1:\n        if (!destinationOrNext) {\n          _this.destination = empty;\n          break;\n        }\n\n        if (typeof destinationOrNext === 'object') {\n          if (destinationOrNext instanceof Subscriber) {\n            _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n            _this.destination = destinationOrNext;\n            destinationOrNext.add(_this);\n          } else {\n            _this.syncErrorThrowable = true;\n            _this.destination = new SafeSubscriber(_this, destinationOrNext);\n          }\n\n          break;\n        }\n\n      default:\n        _this.syncErrorThrowable = true;\n        _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n        break;\n    }\n\n    return _this;\n  }\n\n  Subscriber.prototype[rxSubscriber] = function () {\n    return this;\n  };\n\n  Subscriber.create = function (next, error, complete) {\n    var subscriber = new Subscriber(next, error, complete);\n    subscriber.syncErrorThrowable = false;\n    return subscriber;\n  };\n\n  Subscriber.prototype.next = function (value) {\n    if (!this.isStopped) {\n      this._next(value);\n    }\n  };\n\n  Subscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      this.isStopped = true;\n\n      this._error(err);\n    }\n  };\n\n  Subscriber.prototype.complete = function () {\n    if (!this.isStopped) {\n      this.isStopped = true;\n\n      this._complete();\n    }\n  };\n\n  Subscriber.prototype.unsubscribe = function () {\n    if (this.closed) {\n      return;\n    }\n\n    this.isStopped = true;\n\n    _super.prototype.unsubscribe.call(this);\n  };\n\n  Subscriber.prototype._next = function (value) {\n    this.destination.next(value);\n  };\n\n  Subscriber.prototype._error = function (err) {\n    this.destination.error(err);\n    this.unsubscribe();\n  };\n\n  Subscriber.prototype._complete = function () {\n    this.destination.complete();\n    this.unsubscribe();\n  };\n\n  Subscriber.prototype._unsubscribeAndRecycle = function () {\n    var _parentOrParents = this._parentOrParents;\n    this._parentOrParents = null;\n    this.unsubscribe();\n    this.closed = false;\n    this.isStopped = false;\n    this._parentOrParents = _parentOrParents;\n    return this;\n  };\n\n  return Subscriber;\n}(Subscription);\n\nvar SafeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SafeSubscriber, _super);\n\n  function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n\n    _this._parentSubscriber = _parentSubscriber;\n    var next;\n    var context = _this;\n\n    if (isFunction(observerOrNext)) {\n      next = observerOrNext;\n    } else if (observerOrNext) {\n      next = observerOrNext.next;\n      error = observerOrNext.error;\n      complete = observerOrNext.complete;\n\n      if (observerOrNext !== empty) {\n        context = Object.create(observerOrNext);\n\n        if (isFunction(context.unsubscribe)) {\n          _this.add(context.unsubscribe.bind(context));\n        }\n\n        context.unsubscribe = _this.unsubscribe.bind(_this);\n      }\n    }\n\n    _this._context = context;\n    _this._next = next;\n    _this._error = error;\n    _this._complete = complete;\n    return _this;\n  }\n\n  SafeSubscriber.prototype.next = function (value) {\n    if (!this.isStopped && this._next) {\n      var _parentSubscriber = this._parentSubscriber;\n\n      if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n        this.__tryOrUnsub(this._next, value);\n      } else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n      var useDeprecatedSynchronousErrorHandling = config.useDeprecatedSynchronousErrorHandling;\n\n      if (this._error) {\n        if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(this._error, err);\n\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, this._error, err);\n\n          this.unsubscribe();\n        }\n      } else if (!_parentSubscriber.syncErrorThrowable) {\n        this.unsubscribe();\n\n        if (useDeprecatedSynchronousErrorHandling) {\n          throw err;\n        }\n\n        hostReportError(err);\n      } else {\n        if (useDeprecatedSynchronousErrorHandling) {\n          _parentSubscriber.syncErrorValue = err;\n          _parentSubscriber.syncErrorThrown = true;\n        } else {\n          hostReportError(err);\n        }\n\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.complete = function () {\n    var _this = this;\n\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n\n      if (this._complete) {\n        var wrappedComplete = function () {\n          return _this._complete.call(_this._context);\n        };\n\n        if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(wrappedComplete);\n\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n\n          this.unsubscribe();\n        }\n      } else {\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      this.unsubscribe();\n\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        throw err;\n      } else {\n        hostReportError(err);\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n    if (!config.useDeprecatedSynchronousErrorHandling) {\n      throw new Error('bad call');\n    }\n\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        parent.syncErrorValue = err;\n        parent.syncErrorThrown = true;\n        return true;\n      } else {\n        hostReportError(err);\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  SafeSubscriber.prototype._unsubscribe = function () {\n    var _parentSubscriber = this._parentSubscriber;\n    this._context = null;\n    this._parentSubscriber = null;\n\n    _parentSubscriber.unsubscribe();\n  };\n\n  return SafeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START _Subscriber PURE_IMPORTS_END */\n\n\nfunction canReportError(observer) {\n  while (observer) {\n    var _a = observer,\n        closed_1 = _a.closed,\n        destination = _a.destination,\n        isStopped = _a.isStopped;\n\n    if (closed_1 || isStopped) {\n      return false;\n    } else if (destination && destination instanceof Subscriber) {\n      observer = destination;\n    } else {\n      observer = null;\n    }\n  }\n\n  return true;\n}\n/** PURE_IMPORTS_START _Subscriber,_symbol_rxSubscriber,_Observer PURE_IMPORTS_END */\n\n\nfunction toSubscriber(nextOrObserver, error, complete) {\n  if (nextOrObserver) {\n    if (nextOrObserver instanceof Subscriber) {\n      return nextOrObserver;\n    }\n\n    if (nextOrObserver[rxSubscriber]) {\n      return nextOrObserver[rxSubscriber]();\n    }\n  }\n\n  if (!nextOrObserver && !error && !complete) {\n    return new Subscriber(empty);\n  }\n\n  return new Subscriber(nextOrObserver, error, complete);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar observable = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction identity(x) {\n  return x;\n}\n/** PURE_IMPORTS_START _identity PURE_IMPORTS_END */\n\n\nfunction pipeFromArray(fns) {\n  if (fns.length === 0) {\n    return identity;\n  }\n\n  if (fns.length === 1) {\n    return fns[0];\n  }\n\n  return function piped(input) {\n    return fns.reduce(function (prev, fn) {\n      return fn(prev);\n    }, input);\n  };\n}\n/** PURE_IMPORTS_START _util_canReportError,_util_toSubscriber,_symbol_observable,_util_pipe,_config PURE_IMPORTS_END */\n\n\nvar Observable = /*@__PURE__*/function () {\n  function Observable(subscribe) {\n    this._isScalar = false;\n\n    if (subscribe) {\n      this._subscribe = subscribe;\n    }\n  }\n\n  Observable.prototype.lift = function (operator) {\n    var observable = new Observable();\n    observable.source = this;\n    observable.operator = operator;\n    return observable;\n  };\n\n  Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n    var operator = this.operator;\n    var sink = toSubscriber(observerOrNext, error, complete);\n\n    if (operator) {\n      sink.add(operator.call(sink, this.source));\n    } else {\n      sink.add(this.source || config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable ? this._subscribe(sink) : this._trySubscribe(sink));\n    }\n\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      if (sink.syncErrorThrowable) {\n        sink.syncErrorThrowable = false;\n\n        if (sink.syncErrorThrown) {\n          throw sink.syncErrorValue;\n        }\n      }\n    }\n\n    return sink;\n  };\n\n  Observable.prototype._trySubscribe = function (sink) {\n    try {\n      return this._subscribe(sink);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        sink.syncErrorThrown = true;\n        sink.syncErrorValue = err;\n      }\n\n      if (canReportError(sink)) {\n        sink.error(err);\n      } else {\n        console.warn(err);\n      }\n    }\n  };\n\n  Observable.prototype.forEach = function (next, promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var subscription;\n      subscription = _this.subscribe(function (value) {\n        try {\n          next(value);\n        } catch (err) {\n          reject(err);\n\n          if (subscription) {\n            subscription.unsubscribe();\n          }\n        }\n      }, reject, resolve);\n    });\n  };\n\n  Observable.prototype._subscribe = function (subscriber) {\n    var source = this.source;\n    return source && source.subscribe(subscriber);\n  };\n\n  Observable.prototype[observable] = function () {\n    return this;\n  };\n\n  Observable.prototype.pipe = function () {\n    var operations = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      operations[_i] = arguments[_i];\n    }\n\n    if (operations.length === 0) {\n      return this;\n    }\n\n    return pipeFromArray(operations)(this);\n  };\n\n  Observable.prototype.toPromise = function (promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var value;\n\n      _this.subscribe(function (x) {\n        return value = x;\n      }, function (err) {\n        return reject(err);\n      }, function () {\n        return resolve(value);\n      });\n    });\n  };\n\n  Observable.create = function (subscribe) {\n    return new Observable(subscribe);\n  };\n\n  return Observable;\n}();\n\nfunction getPromiseCtor(promiseCtor) {\n  if (!promiseCtor) {\n    promiseCtor = Promise;\n  }\n\n  if (!promiseCtor) {\n    throw new Error('no Promise impl found');\n  }\n\n  return promiseCtor;\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar ObjectUnsubscribedErrorImpl = /*@__PURE__*/function () {\n  function ObjectUnsubscribedErrorImpl() {\n    Error.call(this);\n    this.message = 'object unsubscribed';\n    this.name = 'ObjectUnsubscribedError';\n    return this;\n  }\n\n  ObjectUnsubscribedErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return ObjectUnsubscribedErrorImpl;\n}();\n\nvar ObjectUnsubscribedError = ObjectUnsubscribedErrorImpl;\n/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\n\nvar SubjectSubscription = /*@__PURE__*/function (_super) {\n  __extends(SubjectSubscription, _super);\n\n  function SubjectSubscription(subject, subscriber) {\n    var _this = _super.call(this) || this;\n\n    _this.subject = subject;\n    _this.subscriber = subscriber;\n    _this.closed = false;\n    return _this;\n  }\n\n  SubjectSubscription.prototype.unsubscribe = function () {\n    if (this.closed) {\n      return;\n    }\n\n    this.closed = true;\n    var subject = this.subject;\n    var observers = subject.observers;\n    this.subject = null;\n\n    if (!observers || observers.length === 0 || subject.isStopped || subject.closed) {\n      return;\n    }\n\n    var subscriberIndex = observers.indexOf(this.subscriber);\n\n    if (subscriberIndex !== -1) {\n      observers.splice(subscriberIndex, 1);\n    }\n  };\n\n  return SubjectSubscription;\n}(Subscription);\n/** PURE_IMPORTS_START tslib,_Observable,_Subscriber,_Subscription,_util_ObjectUnsubscribedError,_SubjectSubscription,_internal_symbol_rxSubscriber PURE_IMPORTS_END */\n\n\nvar SubjectSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SubjectSubscriber, _super);\n\n  function SubjectSubscriber(destination) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.destination = destination;\n    return _this;\n  }\n\n  return SubjectSubscriber;\n}(Subscriber);\n\nvar Subject = /*@__PURE__*/function (_super) {\n  __extends(Subject, _super);\n\n  function Subject() {\n    var _this = _super.call(this) || this;\n\n    _this.observers = [];\n    _this.closed = false;\n    _this.isStopped = false;\n    _this.hasError = false;\n    _this.thrownError = null;\n    return _this;\n  }\n\n  Subject.prototype[rxSubscriber] = function () {\n    return new SubjectSubscriber(this);\n  };\n\n  Subject.prototype.lift = function (operator) {\n    var subject = new AnonymousSubject(this, this);\n    subject.operator = operator;\n    return subject;\n  };\n\n  Subject.prototype.next = function (value) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n\n    if (!this.isStopped) {\n      var observers = this.observers;\n      var len = observers.length;\n      var copy = observers.slice();\n\n      for (var i = 0; i < len; i++) {\n        copy[i].next(value);\n      }\n    }\n  };\n\n  Subject.prototype.error = function (err) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n\n    this.hasError = true;\n    this.thrownError = err;\n    this.isStopped = true;\n    var observers = this.observers;\n    var len = observers.length;\n    var copy = observers.slice();\n\n    for (var i = 0; i < len; i++) {\n      copy[i].error(err);\n    }\n\n    this.observers.length = 0;\n  };\n\n  Subject.prototype.complete = function () {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n\n    this.isStopped = true;\n    var observers = this.observers;\n    var len = observers.length;\n    var copy = observers.slice();\n\n    for (var i = 0; i < len; i++) {\n      copy[i].complete();\n    }\n\n    this.observers.length = 0;\n  };\n\n  Subject.prototype.unsubscribe = function () {\n    this.isStopped = true;\n    this.closed = true;\n    this.observers = null;\n  };\n\n  Subject.prototype._trySubscribe = function (subscriber) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else {\n      return _super.prototype._trySubscribe.call(this, subscriber);\n    }\n  };\n\n  Subject.prototype._subscribe = function (subscriber) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else if (this.hasError) {\n      subscriber.error(this.thrownError);\n      return Subscription.EMPTY;\n    } else if (this.isStopped) {\n      subscriber.complete();\n      return Subscription.EMPTY;\n    } else {\n      this.observers.push(subscriber);\n      return new SubjectSubscription(this, subscriber);\n    }\n  };\n\n  Subject.prototype.asObservable = function () {\n    var observable = new Observable();\n    observable.source = this;\n    return observable;\n  };\n\n  Subject.create = function (destination, source) {\n    return new AnonymousSubject(destination, source);\n  };\n\n  return Subject;\n}(Observable);\n\nvar AnonymousSubject = /*@__PURE__*/function (_super) {\n  __extends(AnonymousSubject, _super);\n\n  function AnonymousSubject(destination, source) {\n    var _this = _super.call(this) || this;\n\n    _this.destination = destination;\n    _this.source = source;\n    return _this;\n  }\n\n  AnonymousSubject.prototype.next = function (value) {\n    var destination = this.destination;\n\n    if (destination && destination.next) {\n      destination.next(value);\n    }\n  };\n\n  AnonymousSubject.prototype.error = function (err) {\n    var destination = this.destination;\n\n    if (destination && destination.error) {\n      this.destination.error(err);\n    }\n  };\n\n  AnonymousSubject.prototype.complete = function () {\n    var destination = this.destination;\n\n    if (destination && destination.complete) {\n      this.destination.complete();\n    }\n  };\n\n  AnonymousSubject.prototype._subscribe = function (subscriber) {\n    var source = this.source;\n\n    if (source) {\n      return this.source.subscribe(subscriber);\n    } else {\n      return Subscription.EMPTY;\n    }\n  };\n\n  return AnonymousSubject;\n}(Subject);\n/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\n\n\nvar Action = /*@__PURE__*/function (_super) {\n  __extends(Action, _super);\n\n  function Action(scheduler, work) {\n    return _super.call(this) || this;\n  }\n\n  Action.prototype.schedule = function (state, delay) {\n    return this;\n  };\n\n  return Action;\n}(Subscription);\n/** PURE_IMPORTS_START tslib,_Action PURE_IMPORTS_END */\n\n\nvar AsyncAction = /*@__PURE__*/function (_super) {\n  __extends(AsyncAction, _super);\n\n  function AsyncAction(scheduler, work) {\n    var _this = _super.call(this, scheduler, work) || this;\n\n    _this.scheduler = scheduler;\n    _this.work = work;\n    _this.pending = false;\n    return _this;\n  }\n\n  AsyncAction.prototype.schedule = function (state, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (this.closed) {\n      return this;\n    }\n\n    this.state = state;\n    var id = this.id;\n    var scheduler = this.scheduler;\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, delay);\n    }\n\n    this.pending = true;\n    this.delay = delay;\n    this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n    return this;\n  };\n\n  AsyncAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    return setInterval(scheduler.flush.bind(scheduler, this), delay);\n  };\n\n  AsyncAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (delay !== null && this.delay === delay && this.pending === false) {\n      return id;\n    }\n\n    clearInterval(id);\n    return undefined;\n  };\n\n  AsyncAction.prototype.execute = function (state, delay) {\n    if (this.closed) {\n      return new Error('executing a cancelled action');\n    }\n\n    this.pending = false;\n\n    var error = this._execute(state, delay);\n\n    if (error) {\n      return error;\n    } else if (this.pending === false && this.id != null) {\n      this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n    }\n  };\n\n  AsyncAction.prototype._execute = function (state, delay) {\n    var errored = false;\n    var errorValue = undefined;\n\n    try {\n      this.work(state);\n    } catch (e) {\n      errored = true;\n      errorValue = !!e && e || new Error(e);\n    }\n\n    if (errored) {\n      this.unsubscribe();\n      return errorValue;\n    }\n  };\n\n  AsyncAction.prototype._unsubscribe = function () {\n    var id = this.id;\n    var scheduler = this.scheduler;\n    var actions = scheduler.actions;\n    var index = actions.indexOf(this);\n    this.work = null;\n    this.state = null;\n    this.pending = false;\n    this.scheduler = null;\n\n    if (index !== -1) {\n      actions.splice(index, 1);\n    }\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, null);\n    }\n\n    this.delay = null;\n  };\n\n  return AsyncAction;\n}(Action);\n\nvar Scheduler = /*@__PURE__*/function () {\n  function Scheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n\n    this.SchedulerAction = SchedulerAction;\n    this.now = now;\n  }\n\n  Scheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    return new this.SchedulerAction(this, work).schedule(state, delay);\n  };\n\n  Scheduler.now = function () {\n    return Date.now();\n  };\n\n  return Scheduler;\n}();\n/** PURE_IMPORTS_START tslib,_Scheduler PURE_IMPORTS_END */\n\n\nvar AsyncScheduler = /*@__PURE__*/function (_super) {\n  __extends(AsyncScheduler, _super);\n\n  function AsyncScheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n\n    var _this = _super.call(this, SchedulerAction, function () {\n      if (AsyncScheduler.delegate && AsyncScheduler.delegate !== _this) {\n        return AsyncScheduler.delegate.now();\n      } else {\n        return now();\n      }\n    }) || this;\n\n    _this.actions = [];\n    _this.active = false;\n    _this.scheduled = undefined;\n    return _this;\n  }\n\n  AsyncScheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n      return AsyncScheduler.delegate.schedule(work, delay, state);\n    } else {\n      return _super.prototype.schedule.call(this, work, delay, state);\n    }\n  };\n\n  AsyncScheduler.prototype.flush = function (action) {\n    var actions = this.actions;\n\n    if (this.active) {\n      actions.push(action);\n      return;\n    }\n\n    var error;\n    this.active = true;\n\n    do {\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    } while (action = actions.shift());\n\n    this.active = false;\n\n    if (error) {\n      while (action = actions.shift()) {\n        action.unsubscribe();\n      }\n\n      throw error;\n    }\n  };\n\n  return AsyncScheduler;\n}(Scheduler);\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\n\nvar EMPTY = /*@__PURE__*/new Observable(function (subscriber) {\n  return subscriber.complete();\n});\n\nfunction empty$1(scheduler) {\n  return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\n\nfunction emptyScheduled(scheduler) {\n  return new Observable(function (subscriber) {\n    return scheduler.schedule(function () {\n      return subscriber.complete();\n    });\n  });\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar subscribeToArray = function (array) {\n  return function (subscriber) {\n    for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n      subscriber.next(array[i]);\n    }\n\n    subscriber.complete();\n  };\n};\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\n\nfunction throwError(error, scheduler) {\n  if (!scheduler) {\n    return new Observable(function (subscriber) {\n      return subscriber.error(error);\n    });\n  } else {\n    return new Observable(function (subscriber) {\n      return scheduler.schedule(dispatch, 0, {\n        error: error,\n        subscriber: subscriber\n      });\n    });\n  }\n}\n\nfunction dispatch(_a) {\n  var error = _a.error,\n      subscriber = _a.subscriber;\n  subscriber.error(error);\n}\n/** PURE_IMPORTS_START _AsyncAction,_AsyncScheduler PURE_IMPORTS_END */\n\n\nvar asyncScheduler = /*@__PURE__*/new AsyncScheduler(AsyncAction);\nvar async = asyncScheduler;\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar ArgumentOutOfRangeErrorImpl = /*@__PURE__*/function () {\n  function ArgumentOutOfRangeErrorImpl() {\n    Error.call(this);\n    this.message = 'argument out of range';\n    this.name = 'ArgumentOutOfRangeError';\n    return this;\n  }\n\n  ArgumentOutOfRangeErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return ArgumentOutOfRangeErrorImpl;\n}();\n\nvar ArgumentOutOfRangeError = ArgumentOutOfRangeErrorImpl;\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar TimeoutErrorImpl = /*@__PURE__*/function () {\n  function TimeoutErrorImpl() {\n    Error.call(this);\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    return this;\n  }\n\n  TimeoutErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return TimeoutErrorImpl;\n}();\n\nvar TimeoutError = TimeoutErrorImpl;\n/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\n\nvar subscribeToPromise = function (promise) {\n  return function (subscriber) {\n    promise.then(function (value) {\n      if (!subscriber.closed) {\n        subscriber.next(value);\n        subscriber.complete();\n      }\n    }, function (err) {\n      return subscriber.error(err);\n    }).then(null, hostReportError);\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction getSymbolIterator() {\n  if (typeof Symbol !== 'function' || !Symbol.iterator) {\n    return '@@iterator';\n  }\n\n  return Symbol.iterator;\n}\n\nvar iterator = /*@__PURE__*/getSymbolIterator();\n/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\n\nvar subscribeToIterable = function (iterable) {\n  return function (subscriber) {\n    var iterator$1 = iterable[iterator]();\n\n    do {\n      var item = void 0;\n\n      try {\n        item = iterator$1.next();\n      } catch (err) {\n        subscriber.error(err);\n        return subscriber;\n      }\n\n      if (item.done) {\n        subscriber.complete();\n        break;\n      }\n\n      subscriber.next(item.value);\n\n      if (subscriber.closed) {\n        break;\n      }\n    } while (true);\n\n    if (typeof iterator$1.return === 'function') {\n      subscriber.add(function () {\n        if (iterator$1.return) {\n          iterator$1.return();\n        }\n      });\n    }\n\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\n\n\nvar subscribeToObservable = function (obj) {\n  return function (subscriber) {\n    var obs = obj[observable]();\n\n    if (typeof obs.subscribe !== 'function') {\n      throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    } else {\n      return obs.subscribe(subscriber);\n    }\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar isArrayLike = function (x) {\n  return x && typeof x.length === 'number' && typeof x !== 'function';\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isPromise(value) {\n  return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n/** PURE_IMPORTS_START _subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\n\n\nvar subscribeTo = function (result) {\n  if (!!result && typeof result[observable] === 'function') {\n    return subscribeToObservable(result);\n  } else if (isArrayLike(result)) {\n    return subscribeToArray(result);\n  } else if (isPromise(result)) {\n    return subscribeToPromise(result);\n  } else if (!!result && typeof result[iterator] === 'function') {\n    return subscribeToIterable(result);\n  } else {\n    var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n    var msg = \"You provided \" + value + \" where a stream was expected.\" + ' You can provide an Observable, Promise, Array, or Iterable.';\n    throw new TypeError(msg);\n  }\n};\n/** PURE_IMPORTS_START tslib,_Subscriber,_Observable,_util_subscribeTo PURE_IMPORTS_END */\n\n\nvar SimpleInnerSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleInnerSubscriber, _super);\n\n  function SimpleInnerSubscriber(parent) {\n    var _this = _super.call(this) || this;\n\n    _this.parent = parent;\n    return _this;\n  }\n\n  SimpleInnerSubscriber.prototype._next = function (value) {\n    this.parent.notifyNext(value);\n  };\n\n  SimpleInnerSubscriber.prototype._error = function (error) {\n    this.parent.notifyError(error);\n    this.unsubscribe();\n  };\n\n  SimpleInnerSubscriber.prototype._complete = function () {\n    this.parent.notifyComplete();\n    this.unsubscribe();\n  };\n\n  return SimpleInnerSubscriber;\n}(Subscriber);\n\nvar SimpleOuterSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleOuterSubscriber, _super);\n\n  function SimpleOuterSubscriber() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SimpleOuterSubscriber.prototype.notifyNext = function (innerValue) {\n    this.destination.next(innerValue);\n  };\n\n  SimpleOuterSubscriber.prototype.notifyError = function (err) {\n    this.destination.error(err);\n  };\n\n  SimpleOuterSubscriber.prototype.notifyComplete = function () {\n    this.destination.complete();\n  };\n\n  return SimpleOuterSubscriber;\n}(Subscriber);\n\nfunction innerSubscribe(result, innerSubscriber) {\n  if (innerSubscriber.closed) {\n    return undefined;\n  }\n\n  if (result instanceof Observable) {\n    return result.subscribe(innerSubscriber);\n  }\n\n  return subscribeTo(result)(innerSubscriber);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isDate(value) {\n  return value instanceof Date && !isNaN(+value);\n}\n/** PURE_IMPORTS_START tslib,_Subscriber,_util_ArgumentOutOfRangeError,_observable_empty PURE_IMPORTS_END */\n\n\nfunction take(count) {\n  return function (source) {\n    if (count === 0) {\n      return empty$1();\n    } else {\n      return source.lift(new TakeOperator(count));\n    }\n  };\n}\n\nvar TakeOperator = /*@__PURE__*/function () {\n  function TakeOperator(total) {\n    this.total = total;\n\n    if (this.total < 0) {\n      throw new ArgumentOutOfRangeError();\n    }\n  }\n\n  TakeOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TakeSubscriber(subscriber, this.total));\n  };\n\n  return TakeOperator;\n}();\n\nvar TakeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TakeSubscriber, _super);\n\n  function TakeSubscriber(destination, total) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.total = total;\n    _this.count = 0;\n    return _this;\n  }\n\n  TakeSubscriber.prototype._next = function (value) {\n    var total = this.total;\n    var count = ++this.count;\n\n    if (count <= total) {\n      this.destination.next(value);\n\n      if (count === total) {\n        this.destination.complete();\n        this.unsubscribe();\n      }\n    }\n  };\n\n  return TakeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_scheduler_async,_util_isDate,_innerSubscribe PURE_IMPORTS_END */\n\n\nfunction timeoutWith(due, withObservable, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n\n  return function (source) {\n    var absoluteTimeout = isDate(due);\n    var waitFor = absoluteTimeout ? +due - scheduler.now() : Math.abs(due);\n    return source.lift(new TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler));\n  };\n}\n\nvar TimeoutWithOperator = /*@__PURE__*/function () {\n  function TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler) {\n    this.waitFor = waitFor;\n    this.absoluteTimeout = absoluteTimeout;\n    this.withObservable = withObservable;\n    this.scheduler = scheduler;\n  }\n\n  TimeoutWithOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TimeoutWithSubscriber(subscriber, this.absoluteTimeout, this.waitFor, this.withObservable, this.scheduler));\n  };\n\n  return TimeoutWithOperator;\n}();\n\nvar TimeoutWithSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TimeoutWithSubscriber, _super);\n\n  function TimeoutWithSubscriber(destination, absoluteTimeout, waitFor, withObservable, scheduler) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.absoluteTimeout = absoluteTimeout;\n    _this.waitFor = waitFor;\n    _this.withObservable = withObservable;\n    _this.scheduler = scheduler;\n\n    _this.scheduleTimeout();\n\n    return _this;\n  }\n\n  TimeoutWithSubscriber.dispatchTimeout = function (subscriber) {\n    var withObservable = subscriber.withObservable;\n\n    subscriber._unsubscribeAndRecycle();\n\n    subscriber.add(innerSubscribe(withObservable, new SimpleInnerSubscriber(subscriber)));\n  };\n\n  TimeoutWithSubscriber.prototype.scheduleTimeout = function () {\n    var action = this.action;\n\n    if (action) {\n      this.action = action.schedule(this, this.waitFor);\n    } else {\n      this.add(this.action = this.scheduler.schedule(TimeoutWithSubscriber.dispatchTimeout, this.waitFor, this));\n    }\n  };\n\n  TimeoutWithSubscriber.prototype._next = function (value) {\n    if (!this.absoluteTimeout) {\n      this.scheduleTimeout();\n    }\n\n    _super.prototype._next.call(this, value);\n  };\n\n  TimeoutWithSubscriber.prototype._unsubscribe = function () {\n    this.action = undefined;\n    this.scheduler = null;\n    this.withObservable = null;\n  };\n\n  return TimeoutWithSubscriber;\n}(SimpleOuterSubscriber);\n/** PURE_IMPORTS_START _scheduler_async,_util_TimeoutError,_timeoutWith,_observable_throwError PURE_IMPORTS_END */\n\n\nfunction timeout(due, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n\n  return timeoutWith(due, throwError(new TimeoutError()), scheduler);\n}\n\nfunction configuration(config) {\n  if (this._destroyed) {\n    throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  }\n\n  const casedScope = this._system === 'ethereum' ? config.scope.toLowerCase() : config.scope; // resolve previous configuration if exists\n\n  const previousConfiguration = this._configurations.get(casedScope);\n\n  previousConfiguration && previousConfiguration.subscription && previousConfiguration.subscription.next();\n  const subscription = new Subject(); // create emitter for transaction\n\n  const emitter = config.watchAddress ? {\n    emitter: createEmitter()\n  } : {};\n\n  this._configurations.set(casedScope, { ...config,\n    ...emitter,\n    subscription\n  });\n\n  this._sendMessage({\n    categoryCode: 'configs',\n    eventCode: 'put',\n    config\n  });\n\n  return new Promise((resolve, reject) => {\n    subscription.pipe(take(1), timeout(5000)).subscribe({\n      next: () => resolve({ ...emitter,\n        details: {\n          config\n        }\n      }),\n      error: error => {\n        const message = error.message === 'Timeout has occurred' ? `Configuration with scope: ${config.scope} has been sent to the Blocknative server, but has not received a reply within 5 seconds.` : error.message;\n\n        if (this._onerror) {\n          this._onerror({\n            message\n          });\n\n          resolve(`Error: ${message}`);\n        } else {\n          reject(message);\n        }\n      }\n    });\n  });\n}\n\nvar version = \"3.4.1\";\n\nfunction sendMessage(msg) {\n  if (this._queuedMessages.length > QUEUE_LIMIT) {\n    throw new Error(`Queue limit of ${QUEUE_LIMIT} messages has been reached.`);\n  }\n\n  this._queuedMessages.push(createEventLog.bind(this)(msg));\n\n  if (!this._processingQueue) {\n    this._processQueue();\n  }\n}\n\nasync function processQueue() {\n  this._processingQueue = true;\n\n  if (!this._connected) {\n    await waitForConnectionOpen.bind(this)();\n  }\n\n  while (this._queuedMessages.length > 0) {\n    // small wait to allow response from server to take affect\n    await wait(1);\n\n    if (this._waitToRetry !== null) {\n      // have been rate limited so wait\n      await this._waitToRetry;\n      this._waitToRetry = null;\n    }\n\n    const msg = this._queuedMessages.shift();\n\n    const delay = this._limitRules.duration / this._limitRules.points * 1000;\n    await wait(delay);\n\n    this._socket.send(msg);\n  }\n\n  this._processingQueue = false;\n  this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n}\n\nfunction handleMessage(msg) {\n  const {\n    status,\n    reason,\n    event,\n    connectionId,\n    serverVersion,\n    retryMs,\n    limitRules,\n    blockedMsg\n  } = JSON.parse(msg.data);\n\n  if (connectionId) {\n    if (typeof window !== 'undefined') {\n      window.localStorage.setItem(this._storageKey, connectionId);\n    }\n\n    this._connectionId = connectionId;\n  } // handle any errors from the server\n\n\n  if (status === 'error') {\n    if (reason.includes('ratelimit') && !reason.match(/IP (PendingSimulation|Notification) ratelimit reached/)) {\n      this._waitToRetry = wait(retryMs);\n      this._limitRules = limitRules; // add blocked msg to the front of the queue\n\n      blockedMsg && this._queuedMessages.unshift(blockedMsg);\n      return;\n    }\n\n    if (reason.includes('not a valid API key')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (reason.includes('network not supported')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (reason.includes('maximum allowed amount')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin txid error\n\n\n    if (reason.includes('invalid txid')) {\n      const reason = `${event.transaction.txid} is an invalid txid`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.txid\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum transaction hash error\n\n\n    if (reason.includes('invalid hash')) {\n      const reason = `${event.transaction.hash} is an invalid transaction hash`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.hash\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle general address error\n\n\n    if (reason.includes('invalid address')) {\n      const reason = `${event.account.address} is an invalid address`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin specific address error\n\n\n    if (reason.includes('not a valid Bitcoin')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum specific address error\n\n\n    if (reason.includes('not a valid Ethereum')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle config error\n\n\n    if (event && event.config) {\n      const configuration = this._configurations.get(event.config.scope);\n\n      if (configuration && configuration.subscription) {\n        configuration.subscription.error({\n          message: reason\n        });\n      }\n\n      return;\n    } // throw error that comes back from the server without formatting the message\n\n\n    if (this._onerror) {\n      this._onerror({\n        message: reason\n      });\n\n      return;\n    } else {\n      throw new Error(reason);\n    }\n  }\n\n  if (event && event.config) {\n    const casedScope = this._system === 'ethereum' ? event.config.scope.toLowerCase() : event.config.scope;\n\n    const configuration = this._configurations.get(casedScope);\n\n    if (configuration && configuration.subscription) {\n      configuration.subscription.next();\n    }\n  }\n\n  if (event && event.transaction) {\n    const {\n      transaction,\n      eventCode,\n      contractCall,\n      timeStamp,\n      blockchain: {\n        system,\n        network\n      }\n    } = event; // flatten in to one object\n\n    const newState = this._system === 'ethereum' ? { ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      system,\n      network,\n      contractCall\n    } : { ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      system,\n      network\n    }; // ignore server echo and unsubscribe messages\n\n    if (serverEcho(eventCode) || transaction.status === 'unsubscribed') {\n      return;\n    } // replace originalHash to match webhook API\n\n\n    if (newState.originalHash) {\n      newState.replaceHash = newState.originalHash;\n      delete newState.originalHash;\n    } // replace status to match webhook API\n\n\n    if (eventCode === 'txSpeedUp' && newState.status !== 'speedup') {\n      newState.status = 'speedup';\n    } // replace status to match webhook API\n\n\n    if (eventCode === 'txCancel' && newState.status !== 'cancel') {\n      newState.status = 'cancel';\n    } // handle change of hash in speedup and cancel events\n\n\n    if (eventCode === 'txSpeedUp' || eventCode === 'txCancel') {\n      this._watchedTransactions = this._watchedTransactions.map(tx => {\n        if (tx.hash === newState.replaceHash) {\n          // reassign hash parameter in transaction queue to new hash or txid\n          tx.hash = transaction.hash || transaction.txid;\n        }\n\n        return tx;\n      });\n    }\n\n    const watchedAddress = transaction.watchedAddress && this._system === 'ethereum' ? transaction.watchedAddress.toLowerCase() : transaction.watchedAddress;\n\n    if (watchedAddress) {\n      const accountObj = this._watchedAccounts.find(ac => ac.address === watchedAddress);\n\n      const accountEmitterResult = accountObj ? last(accountObj.emitters.map(emitter => emitter.emit(newState))) : false;\n\n      const configuration = this._configurations.get(watchedAddress);\n\n      const emitterResult = configuration && configuration.emitter ? configuration.emitter.emit(newState) || accountEmitterResult : accountEmitterResult;\n\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      }));\n    } else {\n      const transactionObj = this._watchedTransactions.find(tx => tx.hash === transaction.hash || transaction.txid);\n\n      const emitterResult = transactionObj && transactionObj.emitter.emit(newState);\n\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      }));\n    }\n  }\n}\n\nfunction createEventLog(msg) {\n  return JSON.stringify({\n    timeStamp: new Date().toISOString(),\n    dappId: this._dappId,\n    version,\n    appName: this._appName,\n    appVersion: this._appVersion,\n    blockchain: {\n      system: this._system,\n      network: networkName(this._system, this._networkId) || 'local'\n    },\n    ...msg\n  }, msg.categoryCode === 'configs' ? jsonPreserveUndefined : undefined);\n}\n\nfunction waitForConnectionOpen() {\n  return new Promise(resolve => {\n    const interval = setInterval(() => {\n      if (this._connected) {\n        setTimeout(resolve, 100);\n        clearInterval(interval);\n      }\n    });\n  });\n}\n\nfunction validateType(options) {\n  const {\n    name,\n    value,\n    type,\n    optional,\n    customValidation\n  } = options;\n\n  if (!optional && typeof value === 'undefined') {\n    throw new Error(`\"${name}\" is required`);\n  }\n\n  if (typeof value !== 'undefined' && (type === 'array' ? Array.isArray(type) : typeof value !== type)) {\n    throw new Error(`\"${name}\" must be of type: ${type}, received type: ${typeof value} from value: ${value}`);\n  }\n\n  if (typeof value !== 'undefined' && customValidation && !customValidation(value)) {\n    throw new Error(`\"${value}\" is not a valid \"${name}\"`);\n  }\n}\n\nfunction validateOptions(options) {\n  validateType({\n    name: 'sdk options',\n    value: options,\n    type: 'object'\n  });\n  const {\n    dappId,\n    system,\n    name,\n    appVersion,\n    networkId,\n    transactionHandlers,\n    apiUrl,\n    ws,\n    onopen,\n    ondown,\n    onreopen,\n    onerror,\n    onclose,\n    ...otherParams\n  } = options;\n  invalidParams(otherParams, ['dappId', 'system', 'name', 'appVersion', 'networkId', 'transactionHandlers', 'apiUrl', 'ws', 'onopen', 'ondown', 'onreopen', 'onerror', 'onclose'], 'Initialization Options');\n  validateType({\n    name: 'dappId',\n    value: dappId,\n    type: 'string'\n  });\n  validateType({\n    name: 'system',\n    value: system,\n    type: 'string',\n    optional: true,\n    customValidation: validSystem\n  });\n  validateType({\n    name: 'name',\n    value: name,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'appVersion',\n    value: appVersion,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'networkId',\n    value: networkId,\n    type: 'number'\n  });\n  validateType({\n    name: 'transactionHandler',\n    value: transactionHandlers,\n    type: 'array',\n    optional: true\n  });\n\n  if (transactionHandlers) {\n    transactionHandlers.forEach(handler => validateType({\n      name: 'transactionHandler',\n      value: handler,\n      type: 'function'\n    }));\n  }\n\n  validateType({\n    name: 'apiUrl',\n    value: apiUrl,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'ws',\n    value: ws,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onopen',\n    value: onopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'ondown',\n    value: ondown,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onreopen',\n    value: onreopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onerror',\n    value: onerror,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onclose',\n    value: onclose,\n    type: 'function',\n    optional: true\n  });\n}\n\nfunction validSystem(system) {\n  return !!networks[system];\n}\n\nfunction invalidParams(params, validParams, functionName) {\n  const invalid = Object.keys(params);\n\n  if (invalid.length > 0) {\n    throw new Error(`${invalid[0]} is not a valid parameter for ${functionName}, must be one of the following valid parameters: ${validParams.join(', ')}`);\n  }\n}\n\nconst DEFAULT_APP_NAME = 'unknown';\nconst DEFAULT_APP_VERSION = 'unknown';\nconst DEFAULT_SYSTEM = 'ethereum';\n\nclass Blocknative {\n  constructor(options) {\n    validateOptions(options);\n    const {\n      dappId,\n      system = DEFAULT_SYSTEM,\n      name = DEFAULT_APP_NAME,\n      appVersion = DEFAULT_APP_VERSION,\n      networkId,\n      transactionHandlers = [],\n      apiUrl,\n      ws,\n      onopen,\n      ondown,\n      onreopen,\n      onerror,\n      onclose\n    } = options;\n    const socket = new SturdyWebSocket(apiUrl || 'wss://api.blocknative.com/v0', ws ? {\n      wsConstructor: ws\n    } : {});\n    socket.onopen = onOpen.bind(this, onopen);\n    socket.ondown = onDown.bind(this, ondown);\n    socket.onreopen = onReopen.bind(this, onreopen);\n    socket.onmessage = handleMessage.bind(this);\n\n    socket.onerror = error => onerror && onerror({\n      message: 'There was a WebSocket error',\n      error\n    });\n\n    socket.onclose = () => {\n      this._pingTimeout && clearInterval(this._pingTimeout);\n      onclose && onclose();\n    };\n\n    const storageKey = CryptoEs.SHA1(`${dappId} - ${name}`).toString();\n    const storedConnectionId = typeof window !== 'undefined' && window.localStorage.getItem(storageKey);\n    this._storageKey = storageKey;\n    this._connectionId = storedConnectionId || undefined;\n    this._dappId = dappId;\n    this._system = system;\n    this._networkId = networkId;\n    this._appName = name;\n    this._appVersion = appVersion;\n    this._transactionHandlers = transactionHandlers;\n    this._socket = socket;\n    this._connected = false;\n    this._sendMessage = sendMessage.bind(this);\n    this._watchedTransactions = [];\n    this._watchedAccounts = [];\n    this._configurations = new Map();\n    this._pingTimeout = undefined;\n    this._destroyed = false;\n    this._onerror = onerror;\n    this._queuedMessages = [];\n    this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n    this._waitToRetry = null;\n    this._processingQueue = false;\n    this._processQueue = processQueue.bind(this);\n\n    if (this._socket.ws.on) {\n      this._heartbeat = () => {\n        this._pingTimeout && clearTimeout(this._pingTimeout);\n        this._pingTimeout = setTimeout(() => {\n          // terminate connection if we haven't heard the server ping after server timeout plus conservative latency delay\n          // Sturdy Websocket will handle the new connection logic\n          this._socket.ws.terminate();\n        }, 30000 + 1000);\n      };\n\n      this._socket.ws.on('ping', () => {\n        this._heartbeat && this._heartbeat();\n      });\n    } // public API\n\n\n    this.transaction = transaction.bind(this);\n    this.account = account.bind(this);\n    this.event = event.bind(this);\n    this.unsubscribe = unsubscribe.bind(this);\n    this.configuration = configuration.bind(this);\n\n    this.destroy = () => {\n      this._socket.close();\n\n      this._destroyed = true; // call onclose manually here as SturdyWebSocket doesn't currently work as expected\n      // https://github.com/dphilipson/sturdy-websocket/issues/5\n\n      this._socket.onclose();\n    };\n  }\n\n}\n\nfunction onOpen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  }; // send this message directly rather than put in queue\n\n  this._socket.send(createEventLog.bind(this)(msg));\n\n  this._heartbeat && this._heartbeat();\n  handler && handler();\n}\n\nfunction onDown(handler, closeEvent) {\n  this._connected = false;\n\n  if (handler) {\n    handler(closeEvent);\n  }\n\n  this._pingTimeout && clearTimeout(this._pingTimeout);\n}\n\nasync function onReopen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  };\n\n  this._socket.send(createEventLog.bind(this)(msg)); // re-register all configurations on re-connection\n\n\n  const configurations = Array.from(this._configurations.values()); // register global config first and wait for it to complete\n\n  const globalConfiguration = this._configurations.get('global');\n\n  if (globalConfiguration) {\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const {\n        emitter,\n        subscription,\n        ...config\n      } = globalConfiguration;\n      await this.configuration(config);\n    } catch (error) {\n      console.warn('Error re-sending global configuration upon reconnection:', error);\n    }\n  }\n\n  const addressConfigurations = configurations.filter(({\n    scope\n  }) => scope !== 'global');\n  addressConfigurations.forEach(enhancedConfig => {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const {\n      emitter,\n      subscription,\n      ...config\n    } = enhancedConfig;\n\n    this._sendMessage({\n      categoryCode: 'configs',\n      eventCode: 'put',\n      config\n    });\n  }); // re-register all accounts to be watched by server upon\n  // re-connection as they don't get transferred over automatically\n  // to the new connection like tx hashes do\n\n  this._watchedAccounts.forEach(account => {\n    this._sendMessage({\n      eventCode: 'accountAddress',\n      categoryCode: 'watch',\n      account: {\n        address: account.address\n      }\n    });\n  });\n\n  if (handler) {\n    handler();\n  }\n\n  if (this._socket.ws.on) {\n    // need to re-register ping event since new connection\n    this._socket.ws.on('ping', () => {\n      this._heartbeat && this._heartbeat();\n    });\n\n    this._heartbeat();\n  }\n}\n\nexport default Blocknative;","map":{"version":3,"sources":["/Users/chrisbuonocore/personal/hackathons/hackfs21/node_modules/bnc-sdk/dist/esm/index.js"],"names":["SturdyWebSocket","CryptoEs","networks","bitcoin","ethereum","DEFAULT_RATE_LIMIT_RULES","points","duration","QUEUE_LIMIT","createEmitter","listeners","on","eventCode","listener","Error","off","emit","state","all","networkName","blockchain","id","serverEcho","last","arr","reverse","isAddress","addressOrHash","length","isTxid","wait","time","Promise","resolve","setTimeout","jsonPreserveUndefined","k","v","undefined","transaction","hash","_destroyed","startTime","Date","now","emitter","_watchedTransactions","push","_system","status","newState","_sendMessage","categoryCode","transactionObj","details","emitState","emitterResult","_transactionHandlers","forEach","handler","bind","account","address","toLowerCase","existingAddressWatcher","_watchedAccounts","find","ac","emitters","event","eventObj","unsubscribe","txid","normalizedAddress","filter","tx","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","prototype","create","isFunction","x","_enable_super_gross_mode_that_will_cause_bad_things","config","useDeprecatedSynchronousErrorHandling","value","error","console","warn","stack","hostReportError","err","empty","closed","next","complete","isArray","isObject","UnsubscriptionErrorImpl","errors","call","message","map","i","toString","join","name","UnsubscriptionError","Subscription","_parentOrParents","_subscriptions","_ctorUnsubscribe","_unsubscribe","_a","remove","index","parent_1","e","flattenUnsubscriptionErrors","len","sub","concat","add","teardown","subscription","EMPTY","tmp","indexOf","subscriptions","subscriptionIndex","splice","reduce","errs","rxSubscriber","Symbol","Math","random","Subscriber","_super","destinationOrNext","_this","syncErrorValue","syncErrorThrown","syncErrorThrowable","isStopped","arguments","destination","SafeSubscriber","subscriber","_next","_error","_complete","_unsubscribeAndRecycle","_parentSubscriber","observerOrNext","context","_context","__tryOrUnsub","__tryOrSetError","wrappedComplete","fn","parent","canReportError","observer","closed_1","toSubscriber","nextOrObserver","observable","identity","pipeFromArray","fns","piped","input","prev","Observable","subscribe","_isScalar","_subscribe","lift","operator","source","sink","_trySubscribe","promiseCtor","getPromiseCtor","reject","pipe","operations","_i","toPromise","ObjectUnsubscribedErrorImpl","ObjectUnsubscribedError","SubjectSubscription","subject","observers","subscriberIndex","SubjectSubscriber","Subject","hasError","thrownError","AnonymousSubject","copy","slice","asObservable","Action","scheduler","work","schedule","delay","AsyncAction","pending","recycleAsyncId","requestAsyncId","setInterval","flush","clearInterval","execute","_execute","errored","errorValue","actions","Scheduler","SchedulerAction","AsyncScheduler","delegate","active","scheduled","action","shift","empty$1","emptyScheduled","subscribeToArray","array","throwError","dispatch","asyncScheduler","async","ArgumentOutOfRangeErrorImpl","ArgumentOutOfRangeError","TimeoutErrorImpl","TimeoutError","subscribeToPromise","promise","then","getSymbolIterator","iterator","subscribeToIterable","iterable","iterator$1","item","done","return","subscribeToObservable","obj","obs","TypeError","isArrayLike","isPromise","subscribeTo","result","msg","SimpleInnerSubscriber","notifyNext","notifyError","notifyComplete","SimpleOuterSubscriber","apply","innerValue","innerSubscribe","innerSubscriber","isDate","isNaN","take","count","TakeOperator","total","TakeSubscriber","timeoutWith","due","withObservable","absoluteTimeout","waitFor","abs","TimeoutWithOperator","TimeoutWithSubscriber","scheduleTimeout","dispatchTimeout","timeout","configuration","casedScope","scope","previousConfiguration","_configurations","get","watchAddress","set","_onerror","version","sendMessage","_queuedMessages","createEventLog","_processingQueue","_processQueue","processQueue","_connected","waitForConnectionOpen","_waitToRetry","_limitRules","_socket","send","handleMessage","reason","connectionId","serverVersion","retryMs","limitRules","blockedMsg","JSON","parse","data","window","localStorage","setItem","_storageKey","_connectionId","includes","match","unshift","contractCall","timeStamp","system","network","originalHash","replaceHash","watchedAddress","accountObj","accountEmitterResult","stringify","toISOString","dappId","_dappId","appName","_appName","appVersion","_appVersion","_networkId","interval","validateType","options","type","optional","customValidation","validateOptions","networkId","transactionHandlers","apiUrl","ws","onopen","ondown","onreopen","onerror","onclose","otherParams","invalidParams","validSystem","params","validParams","functionName","invalid","keys","DEFAULT_APP_NAME","DEFAULT_APP_VERSION","DEFAULT_SYSTEM","Blocknative","socket","wsConstructor","onOpen","onDown","onReopen","onmessage","_pingTimeout","storageKey","SHA1","storedConnectionId","getItem","Map","_heartbeat","clearTimeout","terminate","destroy","close","closeEvent","configurations","from","values","globalConfiguration","addressConfigurations","enhancedConfig"],"mappings":"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","sourcesContent":["import SturdyWebSocket from 'sturdy-websocket';\nimport CryptoEs from 'crypto-es';\nconst networks = {\n  bitcoin: {\n    '1': 'main',\n    '2': 'testnet'\n  },\n  ethereum: {\n    '1': 'main',\n    '3': 'ropsten',\n    '4': 'rinkeby',\n    '5': 'goerli',\n    '42': 'kovan',\n    '56': 'bsc-main',\n    '100': 'xdai'\n  }\n};\nconst DEFAULT_RATE_LIMIT_RULES = {\n  points: 150,\n  duration: 1\n};\nconst QUEUE_LIMIT = 10000;\n\nfunction createEmitter() {\n  return {\n    listeners: {},\n    on: function (eventCode, listener) {\n      // check if valid eventCode\n      switch (eventCode) {\n        case 'txSent':\n        case 'txPool':\n        case 'txConfirmed':\n        case 'txSpeedUp':\n        case 'txCancel':\n        case 'txFailed':\n        case 'txDropped':\n        case 'txRequest':\n        case 'nsfFail':\n        case 'txRepeat':\n        case 'txAwaitingApproval':\n        case 'txConfirmReminder':\n        case 'txSendFail':\n        case 'txError':\n        case 'txUnderPriced':\n        case 'txPoolSimulation':\n        case 'all':\n          break;\n\n        default:\n          throw new Error(`${eventCode} is not a valid event code, for a list of valid event codes see: https://docs.blocknative.com/notify-sdk#event-codes`);\n      } // check that listener is a function\n\n\n      if (typeof listener !== 'function') {\n        throw new Error('Listener must be a function');\n      } // add listener for the eventCode\n\n\n      this.listeners[eventCode] = listener;\n    },\n    off: function (eventCode) {\n      delete this.listeners[eventCode];\n    },\n    emit: function (state) {\n      if (this.listeners[state.eventCode]) {\n        return this.listeners[state.eventCode](state);\n      }\n\n      if (this.listeners.all) {\n        return this.listeners.all(state);\n      }\n    }\n  };\n}\n\nfunction networkName(blockchain, id) {\n  return networks[blockchain][id];\n}\n\nfunction serverEcho(eventCode) {\n  switch (eventCode) {\n    case 'txRequest':\n    case 'nsfFail':\n    case 'txRepeat':\n    case 'txAwaitingApproval':\n    case 'txConfirmReminder':\n    case 'txSendFail':\n    case 'txError':\n    case 'txUnderPriced':\n    case 'txSent':\n      return true;\n\n    default:\n      return false;\n  }\n}\n\nfunction last(arr) {\n  return arr.reverse()[0];\n} // isAddress and isTxid are not meant to perform real validation,\n// just needs to work out if it is an address or a transaction id\n// the server will do more thorough validation\n\n\nfunction isAddress(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 42;\n\n    case 'bitcoin':\n      return addressOrHash.length !== 64;\n\n    default:\n      return false;\n  }\n}\n\nfunction isTxid(blockchain, addressOrHash) {\n  switch (blockchain) {\n    case 'ethereum':\n      return addressOrHash.length === 66;\n\n    case 'bitcoin':\n      return addressOrHash.length === 64;\n\n    default:\n      return false;\n  }\n}\n\nfunction wait(time) {\n  return new Promise(resolve => {\n    setTimeout(resolve, time);\n  });\n}\n\nconst jsonPreserveUndefined = (k, v) => v === undefined ? 'undefined' : v;\n\nfunction transaction(hash, id) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // create startTime for transaction\n\n  const startTime = Date.now(); // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'txSent'; // put in queue\n\n  this._watchedTransactions.push({\n    hash,\n    emitter\n  });\n\n  const transaction = {\n    [this._system === 'ethereum' ? 'hash' : 'txid']: hash,\n    id: id || hash,\n    startTime,\n    status: 'sent'\n  };\n  const newState = { ...transaction,\n    eventCode\n  }; // logEvent to server\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'activeTransaction',\n    transaction\n  });\n\n  const transactionObj = {\n    details: newState,\n    emitter\n  };\n\n  function emitState() {\n    const emitterResult = emitter.emit(newState);\n\n    this._transactionHandlers.forEach(handler => handler({\n      transaction: newState,\n      emitterResult\n    }));\n  } // emit after delay to allow for listener to be registered\n\n\n  setTimeout(emitState.bind(this), 5);\n  return transactionObj;\n}\n\nfunction account(address) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.'); // lowercase the address if Ethereum\n\n  address = this._system === 'ethereum' ? address.toLowerCase() : address; // create emitter for transaction\n\n  const emitter = createEmitter(); // create eventCode for transaction\n\n  const eventCode = 'watch';\n\n  const existingAddressWatcher = this._watchedAccounts.find(ac => ac.address === address);\n\n  if (existingAddressWatcher) {\n    // add to existing emitters array\n    existingAddressWatcher.emitters.push(emitter);\n  } else {\n    // put in accounts queue\n    this._watchedAccounts.push({\n      address,\n      emitters: [emitter]\n    });\n  } // logEvent to server\n\n\n  this._sendMessage({\n    eventCode,\n    categoryCode: 'accountAddress',\n    account: {\n      address\n    }\n  });\n\n  return {\n    emitter,\n    details: {\n      address\n    }\n  };\n}\n\nfunction event(eventObj) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n\n  this._sendMessage(eventObj);\n}\n\nfunction unsubscribe(addressOrHash) {\n  if (this._destroyed) throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  const address = isAddress(this._system, addressOrHash);\n  const txid = isTxid(this._system, addressOrHash); // check if it is an address or a hash\n\n  if (address) {\n    const normalizedAddress = this._system === 'ethereum' ? addressOrHash.toLowerCase() : addressOrHash; // remove address from accounts\n\n    this._watchedAccounts = this._watchedAccounts.filter(ac => ac.address !== normalizedAddress); // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'accountAddress',\n      eventCode: 'unwatch',\n      account: {\n        address: normalizedAddress\n      }\n    });\n  } else if (txid) {\n    // remove transaction from transactions\n    this._watchedTransactions = this._watchedTransactions.filter(tx => tx.hash !== addressOrHash); // logEvent to server\n\n    this._sendMessage({\n      categoryCode: 'activeTransaction',\n      eventCode: 'unwatch',\n      transaction: {\n        [this._system === 'ethereum' ? 'hash' : 'txid']: addressOrHash,\n        id: addressOrHash,\n        status: 'unsubscribed'\n      }\n    });\n  } else {\n    throw new Error(`Error trying to unsubscribe ${addressOrHash}: not a valid address or transaction id/hash`);\n  }\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nvar config = {\n  Promise: undefined,\n\n  set useDeprecatedSynchronousErrorHandling(value) {\n    if (value) {\n      var error = /*@__PURE__*/new Error();\n      /*@__PURE__*/\n\n      console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n    }\n\n    _enable_super_gross_mode_that_will_cause_bad_things = value;\n  },\n\n  get useDeprecatedSynchronousErrorHandling() {\n    return _enable_super_gross_mode_that_will_cause_bad_things;\n  }\n\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nfunction hostReportError(err) {\n  setTimeout(function () {\n    throw err;\n  }, 0);\n}\n/** PURE_IMPORTS_START _config,_util_hostReportError PURE_IMPORTS_END */\n\n\nvar empty = {\n  closed: true,\n  next: function (value) {},\n  error: function (err) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      throw err;\n    } else {\n      hostReportError(err);\n    }\n  },\n  complete: function () {}\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar isArray = /*@__PURE__*/function () {\n  return Array.isArray || function (x) {\n    return x && typeof x.length === 'number';\n  };\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isObject(x) {\n  return x !== null && typeof x === 'object';\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar UnsubscriptionErrorImpl = /*@__PURE__*/function () {\n  function UnsubscriptionErrorImpl(errors) {\n    Error.call(this);\n    this.message = errors ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) {\n      return i + 1 + \") \" + err.toString();\n    }).join('\\n  ') : '';\n    this.name = 'UnsubscriptionError';\n    this.errors = errors;\n    return this;\n  }\n\n  UnsubscriptionErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return UnsubscriptionErrorImpl;\n}();\n\nvar UnsubscriptionError = UnsubscriptionErrorImpl;\n/** PURE_IMPORTS_START _util_isArray,_util_isObject,_util_isFunction,_util_UnsubscriptionError PURE_IMPORTS_END */\n\nvar Subscription = /*@__PURE__*/function () {\n  function Subscription(unsubscribe) {\n    this.closed = false;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n\n    if (unsubscribe) {\n      this._ctorUnsubscribe = true;\n      this._unsubscribe = unsubscribe;\n    }\n  }\n\n  Subscription.prototype.unsubscribe = function () {\n    var errors;\n\n    if (this.closed) {\n      return;\n    }\n\n    var _a = this,\n        _parentOrParents = _a._parentOrParents,\n        _ctorUnsubscribe = _a._ctorUnsubscribe,\n        _unsubscribe = _a._unsubscribe,\n        _subscriptions = _a._subscriptions;\n\n    this.closed = true;\n    this._parentOrParents = null;\n    this._subscriptions = null;\n\n    if (_parentOrParents instanceof Subscription) {\n      _parentOrParents.remove(this);\n    } else if (_parentOrParents !== null) {\n      for (var index = 0; index < _parentOrParents.length; ++index) {\n        var parent_1 = _parentOrParents[index];\n        parent_1.remove(this);\n      }\n    }\n\n    if (isFunction(_unsubscribe)) {\n      if (_ctorUnsubscribe) {\n        this._unsubscribe = undefined;\n      }\n\n      try {\n        _unsubscribe.call(this);\n      } catch (e) {\n        errors = e instanceof UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n      }\n    }\n\n    if (isArray(_subscriptions)) {\n      var index = -1;\n      var len = _subscriptions.length;\n\n      while (++index < len) {\n        var sub = _subscriptions[index];\n\n        if (isObject(sub)) {\n          try {\n            sub.unsubscribe();\n          } catch (e) {\n            errors = errors || [];\n\n            if (e instanceof UnsubscriptionError) {\n              errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n            } else {\n              errors.push(e);\n            }\n          }\n        }\n      }\n    }\n\n    if (errors) {\n      throw new UnsubscriptionError(errors);\n    }\n  };\n\n  Subscription.prototype.add = function (teardown) {\n    var subscription = teardown;\n\n    if (!teardown) {\n      return Subscription.EMPTY;\n    }\n\n    switch (typeof teardown) {\n      case 'function':\n        subscription = new Subscription(teardown);\n\n      case 'object':\n        if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n          return subscription;\n        } else if (this.closed) {\n          subscription.unsubscribe();\n          return subscription;\n        } else if (!(subscription instanceof Subscription)) {\n          var tmp = subscription;\n          subscription = new Subscription();\n          subscription._subscriptions = [tmp];\n        }\n\n        break;\n\n      default:\n        {\n          throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n        }\n    }\n\n    var _parentOrParents = subscription._parentOrParents;\n\n    if (_parentOrParents === null) {\n      subscription._parentOrParents = this;\n    } else if (_parentOrParents instanceof Subscription) {\n      if (_parentOrParents === this) {\n        return subscription;\n      }\n\n      subscription._parentOrParents = [_parentOrParents, this];\n    } else if (_parentOrParents.indexOf(this) === -1) {\n      _parentOrParents.push(this);\n    } else {\n      return subscription;\n    }\n\n    var subscriptions = this._subscriptions;\n\n    if (subscriptions === null) {\n      this._subscriptions = [subscription];\n    } else {\n      subscriptions.push(subscription);\n    }\n\n    return subscription;\n  };\n\n  Subscription.prototype.remove = function (subscription) {\n    var subscriptions = this._subscriptions;\n\n    if (subscriptions) {\n      var subscriptionIndex = subscriptions.indexOf(subscription);\n\n      if (subscriptionIndex !== -1) {\n        subscriptions.splice(subscriptionIndex, 1);\n      }\n    }\n  };\n\n  Subscription.EMPTY = function (empty) {\n    empty.closed = true;\n    return empty;\n  }(new Subscription());\n\n  return Subscription;\n}();\n\nfunction flattenUnsubscriptionErrors(errors) {\n  return errors.reduce(function (errs, err) {\n    return errs.concat(err instanceof UnsubscriptionError ? err.errors : err);\n  }, []);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar rxSubscriber = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' ? /*@__PURE__*/Symbol('rxSubscriber') : '@@rxSubscriber_' + /*@__PURE__*/Math.random();\n}();\n/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */\n\n\nvar Subscriber = /*@__PURE__*/function (_super) {\n  __extends(Subscriber, _super);\n\n  function Subscriber(destinationOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n\n    _this.syncErrorValue = null;\n    _this.syncErrorThrown = false;\n    _this.syncErrorThrowable = false;\n    _this.isStopped = false;\n\n    switch (arguments.length) {\n      case 0:\n        _this.destination = empty;\n        break;\n\n      case 1:\n        if (!destinationOrNext) {\n          _this.destination = empty;\n          break;\n        }\n\n        if (typeof destinationOrNext === 'object') {\n          if (destinationOrNext instanceof Subscriber) {\n            _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n            _this.destination = destinationOrNext;\n            destinationOrNext.add(_this);\n          } else {\n            _this.syncErrorThrowable = true;\n            _this.destination = new SafeSubscriber(_this, destinationOrNext);\n          }\n\n          break;\n        }\n\n      default:\n        _this.syncErrorThrowable = true;\n        _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n        break;\n    }\n\n    return _this;\n  }\n\n  Subscriber.prototype[rxSubscriber] = function () {\n    return this;\n  };\n\n  Subscriber.create = function (next, error, complete) {\n    var subscriber = new Subscriber(next, error, complete);\n    subscriber.syncErrorThrowable = false;\n    return subscriber;\n  };\n\n  Subscriber.prototype.next = function (value) {\n    if (!this.isStopped) {\n      this._next(value);\n    }\n  };\n\n  Subscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      this.isStopped = true;\n\n      this._error(err);\n    }\n  };\n\n  Subscriber.prototype.complete = function () {\n    if (!this.isStopped) {\n      this.isStopped = true;\n\n      this._complete();\n    }\n  };\n\n  Subscriber.prototype.unsubscribe = function () {\n    if (this.closed) {\n      return;\n    }\n\n    this.isStopped = true;\n\n    _super.prototype.unsubscribe.call(this);\n  };\n\n  Subscriber.prototype._next = function (value) {\n    this.destination.next(value);\n  };\n\n  Subscriber.prototype._error = function (err) {\n    this.destination.error(err);\n    this.unsubscribe();\n  };\n\n  Subscriber.prototype._complete = function () {\n    this.destination.complete();\n    this.unsubscribe();\n  };\n\n  Subscriber.prototype._unsubscribeAndRecycle = function () {\n    var _parentOrParents = this._parentOrParents;\n    this._parentOrParents = null;\n    this.unsubscribe();\n    this.closed = false;\n    this.isStopped = false;\n    this._parentOrParents = _parentOrParents;\n    return this;\n  };\n\n  return Subscriber;\n}(Subscription);\n\nvar SafeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SafeSubscriber, _super);\n\n  function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n    var _this = _super.call(this) || this;\n\n    _this._parentSubscriber = _parentSubscriber;\n    var next;\n    var context = _this;\n\n    if (isFunction(observerOrNext)) {\n      next = observerOrNext;\n    } else if (observerOrNext) {\n      next = observerOrNext.next;\n      error = observerOrNext.error;\n      complete = observerOrNext.complete;\n\n      if (observerOrNext !== empty) {\n        context = Object.create(observerOrNext);\n\n        if (isFunction(context.unsubscribe)) {\n          _this.add(context.unsubscribe.bind(context));\n        }\n\n        context.unsubscribe = _this.unsubscribe.bind(_this);\n      }\n    }\n\n    _this._context = context;\n    _this._next = next;\n    _this._error = error;\n    _this._complete = complete;\n    return _this;\n  }\n\n  SafeSubscriber.prototype.next = function (value) {\n    if (!this.isStopped && this._next) {\n      var _parentSubscriber = this._parentSubscriber;\n\n      if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n        this.__tryOrUnsub(this._next, value);\n      } else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.error = function (err) {\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n      var useDeprecatedSynchronousErrorHandling = config.useDeprecatedSynchronousErrorHandling;\n\n      if (this._error) {\n        if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(this._error, err);\n\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, this._error, err);\n\n          this.unsubscribe();\n        }\n      } else if (!_parentSubscriber.syncErrorThrowable) {\n        this.unsubscribe();\n\n        if (useDeprecatedSynchronousErrorHandling) {\n          throw err;\n        }\n\n        hostReportError(err);\n      } else {\n        if (useDeprecatedSynchronousErrorHandling) {\n          _parentSubscriber.syncErrorValue = err;\n          _parentSubscriber.syncErrorThrown = true;\n        } else {\n          hostReportError(err);\n        }\n\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.complete = function () {\n    var _this = this;\n\n    if (!this.isStopped) {\n      var _parentSubscriber = this._parentSubscriber;\n\n      if (this._complete) {\n        var wrappedComplete = function () {\n          return _this._complete.call(_this._context);\n        };\n\n        if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(wrappedComplete);\n\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n\n          this.unsubscribe();\n        }\n      } else {\n        this.unsubscribe();\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      this.unsubscribe();\n\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        throw err;\n      } else {\n        hostReportError(err);\n      }\n    }\n  };\n\n  SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n    if (!config.useDeprecatedSynchronousErrorHandling) {\n      throw new Error('bad call');\n    }\n\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        parent.syncErrorValue = err;\n        parent.syncErrorThrown = true;\n        return true;\n      } else {\n        hostReportError(err);\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  SafeSubscriber.prototype._unsubscribe = function () {\n    var _parentSubscriber = this._parentSubscriber;\n    this._context = null;\n    this._parentSubscriber = null;\n\n    _parentSubscriber.unsubscribe();\n  };\n\n  return SafeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START _Subscriber PURE_IMPORTS_END */\n\n\nfunction canReportError(observer) {\n  while (observer) {\n    var _a = observer,\n        closed_1 = _a.closed,\n        destination = _a.destination,\n        isStopped = _a.isStopped;\n\n    if (closed_1 || isStopped) {\n      return false;\n    } else if (destination && destination instanceof Subscriber) {\n      observer = destination;\n    } else {\n      observer = null;\n    }\n  }\n\n  return true;\n}\n/** PURE_IMPORTS_START _Subscriber,_symbol_rxSubscriber,_Observer PURE_IMPORTS_END */\n\n\nfunction toSubscriber(nextOrObserver, error, complete) {\n  if (nextOrObserver) {\n    if (nextOrObserver instanceof Subscriber) {\n      return nextOrObserver;\n    }\n\n    if (nextOrObserver[rxSubscriber]) {\n      return nextOrObserver[rxSubscriber]();\n    }\n  }\n\n  if (!nextOrObserver && !error && !complete) {\n    return new Subscriber(empty);\n  }\n\n  return new Subscriber(nextOrObserver, error, complete);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar observable = /*@__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction identity(x) {\n  return x;\n}\n/** PURE_IMPORTS_START _identity PURE_IMPORTS_END */\n\n\nfunction pipeFromArray(fns) {\n  if (fns.length === 0) {\n    return identity;\n  }\n\n  if (fns.length === 1) {\n    return fns[0];\n  }\n\n  return function piped(input) {\n    return fns.reduce(function (prev, fn) {\n      return fn(prev);\n    }, input);\n  };\n}\n/** PURE_IMPORTS_START _util_canReportError,_util_toSubscriber,_symbol_observable,_util_pipe,_config PURE_IMPORTS_END */\n\n\nvar Observable = /*@__PURE__*/function () {\n  function Observable(subscribe) {\n    this._isScalar = false;\n\n    if (subscribe) {\n      this._subscribe = subscribe;\n    }\n  }\n\n  Observable.prototype.lift = function (operator) {\n    var observable = new Observable();\n    observable.source = this;\n    observable.operator = operator;\n    return observable;\n  };\n\n  Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n    var operator = this.operator;\n    var sink = toSubscriber(observerOrNext, error, complete);\n\n    if (operator) {\n      sink.add(operator.call(sink, this.source));\n    } else {\n      sink.add(this.source || config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable ? this._subscribe(sink) : this._trySubscribe(sink));\n    }\n\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      if (sink.syncErrorThrowable) {\n        sink.syncErrorThrowable = false;\n\n        if (sink.syncErrorThrown) {\n          throw sink.syncErrorValue;\n        }\n      }\n    }\n\n    return sink;\n  };\n\n  Observable.prototype._trySubscribe = function (sink) {\n    try {\n      return this._subscribe(sink);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        sink.syncErrorThrown = true;\n        sink.syncErrorValue = err;\n      }\n\n      if (canReportError(sink)) {\n        sink.error(err);\n      } else {\n        console.warn(err);\n      }\n    }\n  };\n\n  Observable.prototype.forEach = function (next, promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var subscription;\n      subscription = _this.subscribe(function (value) {\n        try {\n          next(value);\n        } catch (err) {\n          reject(err);\n\n          if (subscription) {\n            subscription.unsubscribe();\n          }\n        }\n      }, reject, resolve);\n    });\n  };\n\n  Observable.prototype._subscribe = function (subscriber) {\n    var source = this.source;\n    return source && source.subscribe(subscriber);\n  };\n\n  Observable.prototype[observable] = function () {\n    return this;\n  };\n\n  Observable.prototype.pipe = function () {\n    var operations = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      operations[_i] = arguments[_i];\n    }\n\n    if (operations.length === 0) {\n      return this;\n    }\n\n    return pipeFromArray(operations)(this);\n  };\n\n  Observable.prototype.toPromise = function (promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var value;\n\n      _this.subscribe(function (x) {\n        return value = x;\n      }, function (err) {\n        return reject(err);\n      }, function () {\n        return resolve(value);\n      });\n    });\n  };\n\n  Observable.create = function (subscribe) {\n    return new Observable(subscribe);\n  };\n\n  return Observable;\n}();\n\nfunction getPromiseCtor(promiseCtor) {\n  if (!promiseCtor) {\n    promiseCtor = Promise;\n  }\n\n  if (!promiseCtor) {\n    throw new Error('no Promise impl found');\n  }\n\n  return promiseCtor;\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar ObjectUnsubscribedErrorImpl = /*@__PURE__*/function () {\n  function ObjectUnsubscribedErrorImpl() {\n    Error.call(this);\n    this.message = 'object unsubscribed';\n    this.name = 'ObjectUnsubscribedError';\n    return this;\n  }\n\n  ObjectUnsubscribedErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return ObjectUnsubscribedErrorImpl;\n}();\n\nvar ObjectUnsubscribedError = ObjectUnsubscribedErrorImpl;\n/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\n\nvar SubjectSubscription = /*@__PURE__*/function (_super) {\n  __extends(SubjectSubscription, _super);\n\n  function SubjectSubscription(subject, subscriber) {\n    var _this = _super.call(this) || this;\n\n    _this.subject = subject;\n    _this.subscriber = subscriber;\n    _this.closed = false;\n    return _this;\n  }\n\n  SubjectSubscription.prototype.unsubscribe = function () {\n    if (this.closed) {\n      return;\n    }\n\n    this.closed = true;\n    var subject = this.subject;\n    var observers = subject.observers;\n    this.subject = null;\n\n    if (!observers || observers.length === 0 || subject.isStopped || subject.closed) {\n      return;\n    }\n\n    var subscriberIndex = observers.indexOf(this.subscriber);\n\n    if (subscriberIndex !== -1) {\n      observers.splice(subscriberIndex, 1);\n    }\n  };\n\n  return SubjectSubscription;\n}(Subscription);\n/** PURE_IMPORTS_START tslib,_Observable,_Subscriber,_Subscription,_util_ObjectUnsubscribedError,_SubjectSubscription,_internal_symbol_rxSubscriber PURE_IMPORTS_END */\n\n\nvar SubjectSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SubjectSubscriber, _super);\n\n  function SubjectSubscriber(destination) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.destination = destination;\n    return _this;\n  }\n\n  return SubjectSubscriber;\n}(Subscriber);\n\nvar Subject = /*@__PURE__*/function (_super) {\n  __extends(Subject, _super);\n\n  function Subject() {\n    var _this = _super.call(this) || this;\n\n    _this.observers = [];\n    _this.closed = false;\n    _this.isStopped = false;\n    _this.hasError = false;\n    _this.thrownError = null;\n    return _this;\n  }\n\n  Subject.prototype[rxSubscriber] = function () {\n    return new SubjectSubscriber(this);\n  };\n\n  Subject.prototype.lift = function (operator) {\n    var subject = new AnonymousSubject(this, this);\n    subject.operator = operator;\n    return subject;\n  };\n\n  Subject.prototype.next = function (value) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n\n    if (!this.isStopped) {\n      var observers = this.observers;\n      var len = observers.length;\n      var copy = observers.slice();\n\n      for (var i = 0; i < len; i++) {\n        copy[i].next(value);\n      }\n    }\n  };\n\n  Subject.prototype.error = function (err) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n\n    this.hasError = true;\n    this.thrownError = err;\n    this.isStopped = true;\n    var observers = this.observers;\n    var len = observers.length;\n    var copy = observers.slice();\n\n    for (var i = 0; i < len; i++) {\n      copy[i].error(err);\n    }\n\n    this.observers.length = 0;\n  };\n\n  Subject.prototype.complete = function () {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n\n    this.isStopped = true;\n    var observers = this.observers;\n    var len = observers.length;\n    var copy = observers.slice();\n\n    for (var i = 0; i < len; i++) {\n      copy[i].complete();\n    }\n\n    this.observers.length = 0;\n  };\n\n  Subject.prototype.unsubscribe = function () {\n    this.isStopped = true;\n    this.closed = true;\n    this.observers = null;\n  };\n\n  Subject.prototype._trySubscribe = function (subscriber) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else {\n      return _super.prototype._trySubscribe.call(this, subscriber);\n    }\n  };\n\n  Subject.prototype._subscribe = function (subscriber) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else if (this.hasError) {\n      subscriber.error(this.thrownError);\n      return Subscription.EMPTY;\n    } else if (this.isStopped) {\n      subscriber.complete();\n      return Subscription.EMPTY;\n    } else {\n      this.observers.push(subscriber);\n      return new SubjectSubscription(this, subscriber);\n    }\n  };\n\n  Subject.prototype.asObservable = function () {\n    var observable = new Observable();\n    observable.source = this;\n    return observable;\n  };\n\n  Subject.create = function (destination, source) {\n    return new AnonymousSubject(destination, source);\n  };\n\n  return Subject;\n}(Observable);\n\nvar AnonymousSubject = /*@__PURE__*/function (_super) {\n  __extends(AnonymousSubject, _super);\n\n  function AnonymousSubject(destination, source) {\n    var _this = _super.call(this) || this;\n\n    _this.destination = destination;\n    _this.source = source;\n    return _this;\n  }\n\n  AnonymousSubject.prototype.next = function (value) {\n    var destination = this.destination;\n\n    if (destination && destination.next) {\n      destination.next(value);\n    }\n  };\n\n  AnonymousSubject.prototype.error = function (err) {\n    var destination = this.destination;\n\n    if (destination && destination.error) {\n      this.destination.error(err);\n    }\n  };\n\n  AnonymousSubject.prototype.complete = function () {\n    var destination = this.destination;\n\n    if (destination && destination.complete) {\n      this.destination.complete();\n    }\n  };\n\n  AnonymousSubject.prototype._subscribe = function (subscriber) {\n    var source = this.source;\n\n    if (source) {\n      return this.source.subscribe(subscriber);\n    } else {\n      return Subscription.EMPTY;\n    }\n  };\n\n  return AnonymousSubject;\n}(Subject);\n/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\n\n\nvar Action = /*@__PURE__*/function (_super) {\n  __extends(Action, _super);\n\n  function Action(scheduler, work) {\n    return _super.call(this) || this;\n  }\n\n  Action.prototype.schedule = function (state, delay) {\n    return this;\n  };\n\n  return Action;\n}(Subscription);\n/** PURE_IMPORTS_START tslib,_Action PURE_IMPORTS_END */\n\n\nvar AsyncAction = /*@__PURE__*/function (_super) {\n  __extends(AsyncAction, _super);\n\n  function AsyncAction(scheduler, work) {\n    var _this = _super.call(this, scheduler, work) || this;\n\n    _this.scheduler = scheduler;\n    _this.work = work;\n    _this.pending = false;\n    return _this;\n  }\n\n  AsyncAction.prototype.schedule = function (state, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (this.closed) {\n      return this;\n    }\n\n    this.state = state;\n    var id = this.id;\n    var scheduler = this.scheduler;\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, delay);\n    }\n\n    this.pending = true;\n    this.delay = delay;\n    this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n    return this;\n  };\n\n  AsyncAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    return setInterval(scheduler.flush.bind(scheduler, this), delay);\n  };\n\n  AsyncAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (delay !== null && this.delay === delay && this.pending === false) {\n      return id;\n    }\n\n    clearInterval(id);\n    return undefined;\n  };\n\n  AsyncAction.prototype.execute = function (state, delay) {\n    if (this.closed) {\n      return new Error('executing a cancelled action');\n    }\n\n    this.pending = false;\n\n    var error = this._execute(state, delay);\n\n    if (error) {\n      return error;\n    } else if (this.pending === false && this.id != null) {\n      this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n    }\n  };\n\n  AsyncAction.prototype._execute = function (state, delay) {\n    var errored = false;\n    var errorValue = undefined;\n\n    try {\n      this.work(state);\n    } catch (e) {\n      errored = true;\n      errorValue = !!e && e || new Error(e);\n    }\n\n    if (errored) {\n      this.unsubscribe();\n      return errorValue;\n    }\n  };\n\n  AsyncAction.prototype._unsubscribe = function () {\n    var id = this.id;\n    var scheduler = this.scheduler;\n    var actions = scheduler.actions;\n    var index = actions.indexOf(this);\n    this.work = null;\n    this.state = null;\n    this.pending = false;\n    this.scheduler = null;\n\n    if (index !== -1) {\n      actions.splice(index, 1);\n    }\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, null);\n    }\n\n    this.delay = null;\n  };\n\n  return AsyncAction;\n}(Action);\n\nvar Scheduler = /*@__PURE__*/function () {\n  function Scheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n\n    this.SchedulerAction = SchedulerAction;\n    this.now = now;\n  }\n\n  Scheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    return new this.SchedulerAction(this, work).schedule(state, delay);\n  };\n\n  Scheduler.now = function () {\n    return Date.now();\n  };\n\n  return Scheduler;\n}();\n/** PURE_IMPORTS_START tslib,_Scheduler PURE_IMPORTS_END */\n\n\nvar AsyncScheduler = /*@__PURE__*/function (_super) {\n  __extends(AsyncScheduler, _super);\n\n  function AsyncScheduler(SchedulerAction, now) {\n    if (now === void 0) {\n      now = Scheduler.now;\n    }\n\n    var _this = _super.call(this, SchedulerAction, function () {\n      if (AsyncScheduler.delegate && AsyncScheduler.delegate !== _this) {\n        return AsyncScheduler.delegate.now();\n      } else {\n        return now();\n      }\n    }) || this;\n\n    _this.actions = [];\n    _this.active = false;\n    _this.scheduled = undefined;\n    return _this;\n  }\n\n  AsyncScheduler.prototype.schedule = function (work, delay, state) {\n    if (delay === void 0) {\n      delay = 0;\n    }\n\n    if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n      return AsyncScheduler.delegate.schedule(work, delay, state);\n    } else {\n      return _super.prototype.schedule.call(this, work, delay, state);\n    }\n  };\n\n  AsyncScheduler.prototype.flush = function (action) {\n    var actions = this.actions;\n\n    if (this.active) {\n      actions.push(action);\n      return;\n    }\n\n    var error;\n    this.active = true;\n\n    do {\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    } while (action = actions.shift());\n\n    this.active = false;\n\n    if (error) {\n      while (action = actions.shift()) {\n        action.unsubscribe();\n      }\n\n      throw error;\n    }\n  };\n\n  return AsyncScheduler;\n}(Scheduler);\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\n\nvar EMPTY = /*@__PURE__*/new Observable(function (subscriber) {\n  return subscriber.complete();\n});\n\nfunction empty$1(scheduler) {\n  return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\n\nfunction emptyScheduled(scheduler) {\n  return new Observable(function (subscriber) {\n    return scheduler.schedule(function () {\n      return subscriber.complete();\n    });\n  });\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar subscribeToArray = function (array) {\n  return function (subscriber) {\n    for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n      subscriber.next(array[i]);\n    }\n\n    subscriber.complete();\n  };\n};\n/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\n\n\nfunction throwError(error, scheduler) {\n  if (!scheduler) {\n    return new Observable(function (subscriber) {\n      return subscriber.error(error);\n    });\n  } else {\n    return new Observable(function (subscriber) {\n      return scheduler.schedule(dispatch, 0, {\n        error: error,\n        subscriber: subscriber\n      });\n    });\n  }\n}\n\nfunction dispatch(_a) {\n  var error = _a.error,\n      subscriber = _a.subscriber;\n  subscriber.error(error);\n}\n/** PURE_IMPORTS_START _AsyncAction,_AsyncScheduler PURE_IMPORTS_END */\n\n\nvar asyncScheduler = /*@__PURE__*/new AsyncScheduler(AsyncAction);\nvar async = asyncScheduler;\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar ArgumentOutOfRangeErrorImpl = /*@__PURE__*/function () {\n  function ArgumentOutOfRangeErrorImpl() {\n    Error.call(this);\n    this.message = 'argument out of range';\n    this.name = 'ArgumentOutOfRangeError';\n    return this;\n  }\n\n  ArgumentOutOfRangeErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return ArgumentOutOfRangeErrorImpl;\n}();\n\nvar ArgumentOutOfRangeError = ArgumentOutOfRangeErrorImpl;\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\nvar TimeoutErrorImpl = /*@__PURE__*/function () {\n  function TimeoutErrorImpl() {\n    Error.call(this);\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    return this;\n  }\n\n  TimeoutErrorImpl.prototype = /*@__PURE__*/Object.create(Error.prototype);\n  return TimeoutErrorImpl;\n}();\n\nvar TimeoutError = TimeoutErrorImpl;\n/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\n\nvar subscribeToPromise = function (promise) {\n  return function (subscriber) {\n    promise.then(function (value) {\n      if (!subscriber.closed) {\n        subscriber.next(value);\n        subscriber.complete();\n      }\n    }, function (err) {\n      return subscriber.error(err);\n    }).then(null, hostReportError);\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction getSymbolIterator() {\n  if (typeof Symbol !== 'function' || !Symbol.iterator) {\n    return '@@iterator';\n  }\n\n  return Symbol.iterator;\n}\n\nvar iterator = /*@__PURE__*/getSymbolIterator();\n/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\n\nvar subscribeToIterable = function (iterable) {\n  return function (subscriber) {\n    var iterator$1 = iterable[iterator]();\n\n    do {\n      var item = void 0;\n\n      try {\n        item = iterator$1.next();\n      } catch (err) {\n        subscriber.error(err);\n        return subscriber;\n      }\n\n      if (item.done) {\n        subscriber.complete();\n        break;\n      }\n\n      subscriber.next(item.value);\n\n      if (subscriber.closed) {\n        break;\n      }\n    } while (true);\n\n    if (typeof iterator$1.return === 'function') {\n      subscriber.add(function () {\n        if (iterator$1.return) {\n          iterator$1.return();\n        }\n      });\n    }\n\n    return subscriber;\n  };\n};\n/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\n\n\nvar subscribeToObservable = function (obj) {\n  return function (subscriber) {\n    var obs = obj[observable]();\n\n    if (typeof obs.subscribe !== 'function') {\n      throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    } else {\n      return obs.subscribe(subscriber);\n    }\n  };\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nvar isArrayLike = function (x) {\n  return x && typeof x.length === 'number' && typeof x !== 'function';\n};\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isPromise(value) {\n  return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n/** PURE_IMPORTS_START _subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\n\n\nvar subscribeTo = function (result) {\n  if (!!result && typeof result[observable] === 'function') {\n    return subscribeToObservable(result);\n  } else if (isArrayLike(result)) {\n    return subscribeToArray(result);\n  } else if (isPromise(result)) {\n    return subscribeToPromise(result);\n  } else if (!!result && typeof result[iterator] === 'function') {\n    return subscribeToIterable(result);\n  } else {\n    var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n    var msg = \"You provided \" + value + \" where a stream was expected.\" + ' You can provide an Observable, Promise, Array, or Iterable.';\n    throw new TypeError(msg);\n  }\n};\n/** PURE_IMPORTS_START tslib,_Subscriber,_Observable,_util_subscribeTo PURE_IMPORTS_END */\n\n\nvar SimpleInnerSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleInnerSubscriber, _super);\n\n  function SimpleInnerSubscriber(parent) {\n    var _this = _super.call(this) || this;\n\n    _this.parent = parent;\n    return _this;\n  }\n\n  SimpleInnerSubscriber.prototype._next = function (value) {\n    this.parent.notifyNext(value);\n  };\n\n  SimpleInnerSubscriber.prototype._error = function (error) {\n    this.parent.notifyError(error);\n    this.unsubscribe();\n  };\n\n  SimpleInnerSubscriber.prototype._complete = function () {\n    this.parent.notifyComplete();\n    this.unsubscribe();\n  };\n\n  return SimpleInnerSubscriber;\n}(Subscriber);\n\nvar SimpleOuterSubscriber = /*@__PURE__*/function (_super) {\n  __extends(SimpleOuterSubscriber, _super);\n\n  function SimpleOuterSubscriber() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SimpleOuterSubscriber.prototype.notifyNext = function (innerValue) {\n    this.destination.next(innerValue);\n  };\n\n  SimpleOuterSubscriber.prototype.notifyError = function (err) {\n    this.destination.error(err);\n  };\n\n  SimpleOuterSubscriber.prototype.notifyComplete = function () {\n    this.destination.complete();\n  };\n\n  return SimpleOuterSubscriber;\n}(Subscriber);\n\nfunction innerSubscribe(result, innerSubscriber) {\n  if (innerSubscriber.closed) {\n    return undefined;\n  }\n\n  if (result instanceof Observable) {\n    return result.subscribe(innerSubscriber);\n  }\n\n  return subscribeTo(result)(innerSubscriber);\n}\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\n\n\nfunction isDate(value) {\n  return value instanceof Date && !isNaN(+value);\n}\n/** PURE_IMPORTS_START tslib,_Subscriber,_util_ArgumentOutOfRangeError,_observable_empty PURE_IMPORTS_END */\n\n\nfunction take(count) {\n  return function (source) {\n    if (count === 0) {\n      return empty$1();\n    } else {\n      return source.lift(new TakeOperator(count));\n    }\n  };\n}\n\nvar TakeOperator = /*@__PURE__*/function () {\n  function TakeOperator(total) {\n    this.total = total;\n\n    if (this.total < 0) {\n      throw new ArgumentOutOfRangeError();\n    }\n  }\n\n  TakeOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TakeSubscriber(subscriber, this.total));\n  };\n\n  return TakeOperator;\n}();\n\nvar TakeSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TakeSubscriber, _super);\n\n  function TakeSubscriber(destination, total) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.total = total;\n    _this.count = 0;\n    return _this;\n  }\n\n  TakeSubscriber.prototype._next = function (value) {\n    var total = this.total;\n    var count = ++this.count;\n\n    if (count <= total) {\n      this.destination.next(value);\n\n      if (count === total) {\n        this.destination.complete();\n        this.unsubscribe();\n      }\n    }\n  };\n\n  return TakeSubscriber;\n}(Subscriber);\n/** PURE_IMPORTS_START tslib,_scheduler_async,_util_isDate,_innerSubscribe PURE_IMPORTS_END */\n\n\nfunction timeoutWith(due, withObservable, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n\n  return function (source) {\n    var absoluteTimeout = isDate(due);\n    var waitFor = absoluteTimeout ? +due - scheduler.now() : Math.abs(due);\n    return source.lift(new TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler));\n  };\n}\n\nvar TimeoutWithOperator = /*@__PURE__*/function () {\n  function TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler) {\n    this.waitFor = waitFor;\n    this.absoluteTimeout = absoluteTimeout;\n    this.withObservable = withObservable;\n    this.scheduler = scheduler;\n  }\n\n  TimeoutWithOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new TimeoutWithSubscriber(subscriber, this.absoluteTimeout, this.waitFor, this.withObservable, this.scheduler));\n  };\n\n  return TimeoutWithOperator;\n}();\n\nvar TimeoutWithSubscriber = /*@__PURE__*/function (_super) {\n  __extends(TimeoutWithSubscriber, _super);\n\n  function TimeoutWithSubscriber(destination, absoluteTimeout, waitFor, withObservable, scheduler) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.absoluteTimeout = absoluteTimeout;\n    _this.waitFor = waitFor;\n    _this.withObservable = withObservable;\n    _this.scheduler = scheduler;\n\n    _this.scheduleTimeout();\n\n    return _this;\n  }\n\n  TimeoutWithSubscriber.dispatchTimeout = function (subscriber) {\n    var withObservable = subscriber.withObservable;\n\n    subscriber._unsubscribeAndRecycle();\n\n    subscriber.add(innerSubscribe(withObservable, new SimpleInnerSubscriber(subscriber)));\n  };\n\n  TimeoutWithSubscriber.prototype.scheduleTimeout = function () {\n    var action = this.action;\n\n    if (action) {\n      this.action = action.schedule(this, this.waitFor);\n    } else {\n      this.add(this.action = this.scheduler.schedule(TimeoutWithSubscriber.dispatchTimeout, this.waitFor, this));\n    }\n  };\n\n  TimeoutWithSubscriber.prototype._next = function (value) {\n    if (!this.absoluteTimeout) {\n      this.scheduleTimeout();\n    }\n\n    _super.prototype._next.call(this, value);\n  };\n\n  TimeoutWithSubscriber.prototype._unsubscribe = function () {\n    this.action = undefined;\n    this.scheduler = null;\n    this.withObservable = null;\n  };\n\n  return TimeoutWithSubscriber;\n}(SimpleOuterSubscriber);\n/** PURE_IMPORTS_START _scheduler_async,_util_TimeoutError,_timeoutWith,_observable_throwError PURE_IMPORTS_END */\n\n\nfunction timeout(due, scheduler) {\n  if (scheduler === void 0) {\n    scheduler = async;\n  }\n\n  return timeoutWith(due, throwError(new TimeoutError()), scheduler);\n}\n\nfunction configuration(config) {\n  if (this._destroyed) {\n    throw new Error('The WebSocket instance has been destroyed, re-initialize to continue making requests.');\n  }\n\n  const casedScope = this._system === 'ethereum' ? config.scope.toLowerCase() : config.scope; // resolve previous configuration if exists\n\n  const previousConfiguration = this._configurations.get(casedScope);\n\n  previousConfiguration && previousConfiguration.subscription && previousConfiguration.subscription.next();\n  const subscription = new Subject(); // create emitter for transaction\n\n  const emitter = config.watchAddress ? {\n    emitter: createEmitter()\n  } : {};\n\n  this._configurations.set(casedScope, { ...config,\n    ...emitter,\n    subscription\n  });\n\n  this._sendMessage({\n    categoryCode: 'configs',\n    eventCode: 'put',\n    config\n  });\n\n  return new Promise((resolve, reject) => {\n    subscription.pipe(take(1), timeout(5000)).subscribe({\n      next: () => resolve({ ...emitter,\n        details: {\n          config\n        }\n      }),\n      error: error => {\n        const message = error.message === 'Timeout has occurred' ? `Configuration with scope: ${config.scope} has been sent to the Blocknative server, but has not received a reply within 5 seconds.` : error.message;\n\n        if (this._onerror) {\n          this._onerror({\n            message\n          });\n\n          resolve(`Error: ${message}`);\n        } else {\n          reject(message);\n        }\n      }\n    });\n  });\n}\n\nvar version = \"3.4.1\";\n\nfunction sendMessage(msg) {\n  if (this._queuedMessages.length > QUEUE_LIMIT) {\n    throw new Error(`Queue limit of ${QUEUE_LIMIT} messages has been reached.`);\n  }\n\n  this._queuedMessages.push(createEventLog.bind(this)(msg));\n\n  if (!this._processingQueue) {\n    this._processQueue();\n  }\n}\n\nasync function processQueue() {\n  this._processingQueue = true;\n\n  if (!this._connected) {\n    await waitForConnectionOpen.bind(this)();\n  }\n\n  while (this._queuedMessages.length > 0) {\n    // small wait to allow response from server to take affect\n    await wait(1);\n\n    if (this._waitToRetry !== null) {\n      // have been rate limited so wait\n      await this._waitToRetry;\n      this._waitToRetry = null;\n    }\n\n    const msg = this._queuedMessages.shift();\n\n    const delay = this._limitRules.duration / this._limitRules.points * 1000;\n    await wait(delay);\n\n    this._socket.send(msg);\n  }\n\n  this._processingQueue = false;\n  this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n}\n\nfunction handleMessage(msg) {\n  const {\n    status,\n    reason,\n    event,\n    connectionId,\n    serverVersion,\n    retryMs,\n    limitRules,\n    blockedMsg\n  } = JSON.parse(msg.data);\n\n  if (connectionId) {\n    if (typeof window !== 'undefined') {\n      window.localStorage.setItem(this._storageKey, connectionId);\n    }\n\n    this._connectionId = connectionId;\n  } // handle any errors from the server\n\n\n  if (status === 'error') {\n    if (reason.includes('ratelimit') && !reason.match(/IP (PendingSimulation|Notification) ratelimit reached/)) {\n      this._waitToRetry = wait(retryMs);\n      this._limitRules = limitRules; // add blocked msg to the front of the queue\n\n      blockedMsg && this._queuedMessages.unshift(blockedMsg);\n      return;\n    }\n\n    if (reason.includes('not a valid API key')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (reason.includes('network not supported')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    }\n\n    if (reason.includes('maximum allowed amount')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin txid error\n\n\n    if (reason.includes('invalid txid')) {\n      const reason = `${event.transaction.txid} is an invalid txid`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.txid\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum transaction hash error\n\n\n    if (reason.includes('invalid hash')) {\n      const reason = `${event.transaction.hash} is an invalid transaction hash`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          transaction: event.transaction.hash\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle general address error\n\n\n    if (reason.includes('invalid address')) {\n      const reason = `${event.account.address} is an invalid address`;\n\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle bitcoin specific address error\n\n\n    if (reason.includes('not a valid Bitcoin')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle ethereum specific address error\n\n\n    if (reason.includes('not a valid Ethereum')) {\n      if (this._onerror) {\n        this._onerror({\n          message: reason,\n          account: event.account.address\n        });\n\n        return;\n      } else {\n        throw new Error(reason);\n      }\n    } // handle config error\n\n\n    if (event && event.config) {\n      const configuration = this._configurations.get(event.config.scope);\n\n      if (configuration && configuration.subscription) {\n        configuration.subscription.error({\n          message: reason\n        });\n      }\n\n      return;\n    } // throw error that comes back from the server without formatting the message\n\n\n    if (this._onerror) {\n      this._onerror({\n        message: reason\n      });\n\n      return;\n    } else {\n      throw new Error(reason);\n    }\n  }\n\n  if (event && event.config) {\n    const casedScope = this._system === 'ethereum' ? event.config.scope.toLowerCase() : event.config.scope;\n\n    const configuration = this._configurations.get(casedScope);\n\n    if (configuration && configuration.subscription) {\n      configuration.subscription.next();\n    }\n  }\n\n  if (event && event.transaction) {\n    const {\n      transaction,\n      eventCode,\n      contractCall,\n      timeStamp,\n      blockchain: {\n        system,\n        network\n      }\n    } = event; // flatten in to one object\n\n    const newState = this._system === 'ethereum' ? { ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      system,\n      network,\n      contractCall\n    } : { ...transaction,\n      serverVersion,\n      eventCode,\n      timeStamp,\n      system,\n      network\n    }; // ignore server echo and unsubscribe messages\n\n    if (serverEcho(eventCode) || transaction.status === 'unsubscribed') {\n      return;\n    } // replace originalHash to match webhook API\n\n\n    if (newState.originalHash) {\n      newState.replaceHash = newState.originalHash;\n      delete newState.originalHash;\n    } // replace status to match webhook API\n\n\n    if (eventCode === 'txSpeedUp' && newState.status !== 'speedup') {\n      newState.status = 'speedup';\n    } // replace status to match webhook API\n\n\n    if (eventCode === 'txCancel' && newState.status !== 'cancel') {\n      newState.status = 'cancel';\n    } // handle change of hash in speedup and cancel events\n\n\n    if (eventCode === 'txSpeedUp' || eventCode === 'txCancel') {\n      this._watchedTransactions = this._watchedTransactions.map(tx => {\n        if (tx.hash === newState.replaceHash) {\n          // reassign hash parameter in transaction queue to new hash or txid\n          tx.hash = transaction.hash || transaction.txid;\n        }\n\n        return tx;\n      });\n    }\n\n    const watchedAddress = transaction.watchedAddress && this._system === 'ethereum' ? transaction.watchedAddress.toLowerCase() : transaction.watchedAddress;\n\n    if (watchedAddress) {\n      const accountObj = this._watchedAccounts.find(ac => ac.address === watchedAddress);\n\n      const accountEmitterResult = accountObj ? last(accountObj.emitters.map(emitter => emitter.emit(newState))) : false;\n\n      const configuration = this._configurations.get(watchedAddress);\n\n      const emitterResult = configuration && configuration.emitter ? configuration.emitter.emit(newState) || accountEmitterResult : accountEmitterResult;\n\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      }));\n    } else {\n      const transactionObj = this._watchedTransactions.find(tx => tx.hash === transaction.hash || transaction.txid);\n\n      const emitterResult = transactionObj && transactionObj.emitter.emit(newState);\n\n      this._transactionHandlers.forEach(handler => handler({\n        transaction: newState,\n        emitterResult\n      }));\n    }\n  }\n}\n\nfunction createEventLog(msg) {\n  return JSON.stringify({\n    timeStamp: new Date().toISOString(),\n    dappId: this._dappId,\n    version,\n    appName: this._appName,\n    appVersion: this._appVersion,\n    blockchain: {\n      system: this._system,\n      network: networkName(this._system, this._networkId) || 'local'\n    },\n    ...msg\n  }, msg.categoryCode === 'configs' ? jsonPreserveUndefined : undefined);\n}\n\nfunction waitForConnectionOpen() {\n  return new Promise(resolve => {\n    const interval = setInterval(() => {\n      if (this._connected) {\n        setTimeout(resolve, 100);\n        clearInterval(interval);\n      }\n    });\n  });\n}\n\nfunction validateType(options) {\n  const {\n    name,\n    value,\n    type,\n    optional,\n    customValidation\n  } = options;\n\n  if (!optional && typeof value === 'undefined') {\n    throw new Error(`\"${name}\" is required`);\n  }\n\n  if (typeof value !== 'undefined' && (type === 'array' ? Array.isArray(type) : typeof value !== type)) {\n    throw new Error(`\"${name}\" must be of type: ${type}, received type: ${typeof value} from value: ${value}`);\n  }\n\n  if (typeof value !== 'undefined' && customValidation && !customValidation(value)) {\n    throw new Error(`\"${value}\" is not a valid \"${name}\"`);\n  }\n}\n\nfunction validateOptions(options) {\n  validateType({\n    name: 'sdk options',\n    value: options,\n    type: 'object'\n  });\n  const {\n    dappId,\n    system,\n    name,\n    appVersion,\n    networkId,\n    transactionHandlers,\n    apiUrl,\n    ws,\n    onopen,\n    ondown,\n    onreopen,\n    onerror,\n    onclose,\n    ...otherParams\n  } = options;\n  invalidParams(otherParams, ['dappId', 'system', 'name', 'appVersion', 'networkId', 'transactionHandlers', 'apiUrl', 'ws', 'onopen', 'ondown', 'onreopen', 'onerror', 'onclose'], 'Initialization Options');\n  validateType({\n    name: 'dappId',\n    value: dappId,\n    type: 'string'\n  });\n  validateType({\n    name: 'system',\n    value: system,\n    type: 'string',\n    optional: true,\n    customValidation: validSystem\n  });\n  validateType({\n    name: 'name',\n    value: name,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'appVersion',\n    value: appVersion,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'networkId',\n    value: networkId,\n    type: 'number'\n  });\n  validateType({\n    name: 'transactionHandler',\n    value: transactionHandlers,\n    type: 'array',\n    optional: true\n  });\n\n  if (transactionHandlers) {\n    transactionHandlers.forEach(handler => validateType({\n      name: 'transactionHandler',\n      value: handler,\n      type: 'function'\n    }));\n  }\n\n  validateType({\n    name: 'apiUrl',\n    value: apiUrl,\n    type: 'string',\n    optional: true\n  });\n  validateType({\n    name: 'ws',\n    value: ws,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onopen',\n    value: onopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'ondown',\n    value: ondown,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onreopen',\n    value: onreopen,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onerror',\n    value: onerror,\n    type: 'function',\n    optional: true\n  });\n  validateType({\n    name: 'onclose',\n    value: onclose,\n    type: 'function',\n    optional: true\n  });\n}\n\nfunction validSystem(system) {\n  return !!networks[system];\n}\n\nfunction invalidParams(params, validParams, functionName) {\n  const invalid = Object.keys(params);\n\n  if (invalid.length > 0) {\n    throw new Error(`${invalid[0]} is not a valid parameter for ${functionName}, must be one of the following valid parameters: ${validParams.join(', ')}`);\n  }\n}\n\nconst DEFAULT_APP_NAME = 'unknown';\nconst DEFAULT_APP_VERSION = 'unknown';\nconst DEFAULT_SYSTEM = 'ethereum';\n\nclass Blocknative {\n  constructor(options) {\n    validateOptions(options);\n    const {\n      dappId,\n      system = DEFAULT_SYSTEM,\n      name = DEFAULT_APP_NAME,\n      appVersion = DEFAULT_APP_VERSION,\n      networkId,\n      transactionHandlers = [],\n      apiUrl,\n      ws,\n      onopen,\n      ondown,\n      onreopen,\n      onerror,\n      onclose\n    } = options;\n    const socket = new SturdyWebSocket(apiUrl || 'wss://api.blocknative.com/v0', ws ? {\n      wsConstructor: ws\n    } : {});\n    socket.onopen = onOpen.bind(this, onopen);\n    socket.ondown = onDown.bind(this, ondown);\n    socket.onreopen = onReopen.bind(this, onreopen);\n    socket.onmessage = handleMessage.bind(this);\n\n    socket.onerror = error => onerror && onerror({\n      message: 'There was a WebSocket error',\n      error\n    });\n\n    socket.onclose = () => {\n      this._pingTimeout && clearInterval(this._pingTimeout);\n      onclose && onclose();\n    };\n\n    const storageKey = CryptoEs.SHA1(`${dappId} - ${name}`).toString();\n    const storedConnectionId = typeof window !== 'undefined' && window.localStorage.getItem(storageKey);\n    this._storageKey = storageKey;\n    this._connectionId = storedConnectionId || undefined;\n    this._dappId = dappId;\n    this._system = system;\n    this._networkId = networkId;\n    this._appName = name;\n    this._appVersion = appVersion;\n    this._transactionHandlers = transactionHandlers;\n    this._socket = socket;\n    this._connected = false;\n    this._sendMessage = sendMessage.bind(this);\n    this._watchedTransactions = [];\n    this._watchedAccounts = [];\n    this._configurations = new Map();\n    this._pingTimeout = undefined;\n    this._destroyed = false;\n    this._onerror = onerror;\n    this._queuedMessages = [];\n    this._limitRules = DEFAULT_RATE_LIMIT_RULES;\n    this._waitToRetry = null;\n    this._processingQueue = false;\n    this._processQueue = processQueue.bind(this);\n\n    if (this._socket.ws.on) {\n      this._heartbeat = () => {\n        this._pingTimeout && clearTimeout(this._pingTimeout);\n        this._pingTimeout = setTimeout(() => {\n          // terminate connection if we haven't heard the server ping after server timeout plus conservative latency delay\n          // Sturdy Websocket will handle the new connection logic\n          this._socket.ws.terminate();\n        }, 30000 + 1000);\n      };\n\n      this._socket.ws.on('ping', () => {\n        this._heartbeat && this._heartbeat();\n      });\n    } // public API\n\n\n    this.transaction = transaction.bind(this);\n    this.account = account.bind(this);\n    this.event = event.bind(this);\n    this.unsubscribe = unsubscribe.bind(this);\n    this.configuration = configuration.bind(this);\n\n    this.destroy = () => {\n      this._socket.close();\n\n      this._destroyed = true; // call onclose manually here as SturdyWebSocket doesn't currently work as expected\n      // https://github.com/dphilipson/sturdy-websocket/issues/5\n\n      this._socket.onclose();\n    };\n  }\n\n}\n\nfunction onOpen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  }; // send this message directly rather than put in queue\n\n  this._socket.send(createEventLog.bind(this)(msg));\n\n  this._heartbeat && this._heartbeat();\n  handler && handler();\n}\n\nfunction onDown(handler, closeEvent) {\n  this._connected = false;\n\n  if (handler) {\n    handler(closeEvent);\n  }\n\n  this._pingTimeout && clearTimeout(this._pingTimeout);\n}\n\nasync function onReopen(handler) {\n  this._connected = true;\n  const msg = {\n    categoryCode: 'initialize',\n    eventCode: 'checkDappId',\n    connectionId: this._connectionId\n  };\n\n  this._socket.send(createEventLog.bind(this)(msg)); // re-register all configurations on re-connection\n\n\n  const configurations = Array.from(this._configurations.values()); // register global config first and wait for it to complete\n\n  const globalConfiguration = this._configurations.get('global');\n\n  if (globalConfiguration) {\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const {\n        emitter,\n        subscription,\n        ...config\n      } = globalConfiguration;\n      await this.configuration(config);\n    } catch (error) {\n      console.warn('Error re-sending global configuration upon reconnection:', error);\n    }\n  }\n\n  const addressConfigurations = configurations.filter(({\n    scope\n  }) => scope !== 'global');\n  addressConfigurations.forEach(enhancedConfig => {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const {\n      emitter,\n      subscription,\n      ...config\n    } = enhancedConfig;\n\n    this._sendMessage({\n      categoryCode: 'configs',\n      eventCode: 'put',\n      config\n    });\n  }); // re-register all accounts to be watched by server upon\n  // re-connection as they don't get transferred over automatically\n  // to the new connection like tx hashes do\n\n  this._watchedAccounts.forEach(account => {\n    this._sendMessage({\n      eventCode: 'accountAddress',\n      categoryCode: 'watch',\n      account: {\n        address: account.address\n      }\n    });\n  });\n\n  if (handler) {\n    handler();\n  }\n\n  if (this._socket.ws.on) {\n    // need to re-register ping event since new connection\n    this._socket.ws.on('ping', () => {\n      this._heartbeat && this._heartbeat();\n    });\n\n    this._heartbeat();\n  }\n}\n\nexport default Blocknative;\n"]},"metadata":{},"sourceType":"module"}