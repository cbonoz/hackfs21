{"ast":null,"code":"import { StreamCipher } from './cipher-core.js';\n\nfunction generateKeystreamWord() {\n  // Shortcuts\n  const S = this._S;\n  let i = this._i;\n  let j = this._j; // Generate keystream word\n\n  let keystreamWord = 0;\n\n  for (let n = 0; n < 4; n += 1) {\n    i = (i + 1) % 256;\n    j = (j + S[i]) % 256; // Swap\n\n    const t = S[i];\n    S[i] = S[j];\n    S[j] = t;\n    keystreamWord |= S[(S[i] + S[j]) % 256] << 24 - n * 8;\n  } // Update counters\n\n\n  this._i = i;\n  this._j = j;\n  return keystreamWord;\n}\n/**\n * RC4 stream cipher algorithm.\n */\n\n\nexport class RC4Algo extends StreamCipher {\n  _doReset() {\n    // Shortcuts\n    const key = this._key;\n    const keyWords = key.words;\n    const keySigBytes = key.sigBytes; // Init sbox\n\n    this._S = [];\n    const S = this._S;\n\n    for (let i = 0; i < 256; i += 1) {\n      S[i] = i;\n    } // Key setup\n\n\n    for (let i = 0, j = 0; i < 256; i += 1) {\n      const keyByteIndex = i % keySigBytes;\n      const keyByte = keyWords[keyByteIndex >>> 2] >>> 24 - keyByteIndex % 4 * 8 & 0xff;\n      j = (j + S[i] + keyByte) % 256; // Swap\n\n      const t = S[i];\n      S[i] = S[j];\n      S[j] = t;\n    } // Counters\n\n\n    this._j = 0;\n    this._i = this._j;\n  }\n\n  _doProcessBlock(M, offset) {\n    const _M = M;\n    _M[offset] ^= generateKeystreamWord.call(this);\n  }\n\n}\nRC4Algo.keySize = 256 / 32;\nRC4Algo.ivSize = 0;\n/**\n * Shortcut functions to the cipher's object interface.\n *\n * @example\n *\n *     var ciphertext = CryptoJS.RC4.encrypt(message, key, cfg);\n *     var plaintext  = CryptoJS.RC4.decrypt(ciphertext, key, cfg);\n */\n\nexport const RC4 = StreamCipher._createHelper(RC4Algo);\n/**\n * Modified RC4 stream cipher algorithm.\n */\n\nexport class RC4DropAlgo extends RC4Algo {\n  constructor(...args) {\n    super(...args);\n    /**\n     * Configuration options.\n     *\n     * @property {number} drop The number of keystream words to drop. Default 192\n     */\n\n    Object.assign(this.cfg, {\n      drop: 192\n    });\n  }\n\n  _doReset() {\n    super._doReset.call(this); // Drop\n\n\n    for (let i = this.cfg.drop; i > 0; i -= 1) {\n      generateKeystreamWord.call(this);\n    }\n  }\n\n}\n/**\n * Shortcut functions to the cipher's object interface.\n *\n * @example\n *\n *     var ciphertext = CryptoJS.RC4Drop.encrypt(message, key, cfg);\n *     var plaintext  = CryptoJS.RC4Drop.decrypt(ciphertext, key, cfg);\n */\n\nexport const RC4Drop = StreamCipher._createHelper(RC4DropAlgo);","map":{"version":3,"sources":["/Users/chrisbuonocore/personal/hackathons/hackfs21/node_modules/crypto-es/lib/rc4.js"],"names":["StreamCipher","generateKeystreamWord","S","_S","i","_i","j","_j","keystreamWord","n","t","RC4Algo","_doReset","key","_key","keyWords","words","keySigBytes","sigBytes","keyByteIndex","keyByte","_doProcessBlock","M","offset","_M","call","keySize","ivSize","RC4","_createHelper","RC4DropAlgo","constructor","args","Object","assign","cfg","drop","RC4Drop"],"mappings":"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","sourcesContent":["import {\n  StreamCipher,\n} from './cipher-core.js';\n\nfunction generateKeystreamWord() {\n  // Shortcuts\n  const S = this._S;\n  let i = this._i;\n  let j = this._j;\n\n  // Generate keystream word\n  let keystreamWord = 0;\n  for (let n = 0; n < 4; n += 1) {\n    i = (i + 1) % 256;\n    j = (j + S[i]) % 256;\n\n    // Swap\n    const t = S[i];\n    S[i] = S[j];\n    S[j] = t;\n\n    keystreamWord |= S[(S[i] + S[j]) % 256] << (24 - n * 8);\n  }\n\n  // Update counters\n  this._i = i;\n  this._j = j;\n\n  return keystreamWord;\n}\n\n/**\n * RC4 stream cipher algorithm.\n */\nexport class RC4Algo extends StreamCipher {\n  _doReset() {\n    // Shortcuts\n    const key = this._key;\n    const keyWords = key.words;\n    const keySigBytes = key.sigBytes;\n\n    // Init sbox\n    this._S = [];\n    const S = this._S;\n    for (let i = 0; i < 256; i += 1) {\n      S[i] = i;\n    }\n\n    // Key setup\n    for (let i = 0, j = 0; i < 256; i += 1) {\n      const keyByteIndex = i % keySigBytes;\n      const keyByte = (keyWords[keyByteIndex >>> 2] >>> (24 - (keyByteIndex % 4) * 8)) & 0xff;\n\n      j = (j + S[i] + keyByte) % 256;\n\n      // Swap\n      const t = S[i];\n      S[i] = S[j];\n      S[j] = t;\n    }\n\n    // Counters\n    this._j = 0;\n    this._i = this._j;\n  }\n\n  _doProcessBlock(M, offset) {\n    const _M = M;\n\n    _M[offset] ^= generateKeystreamWord.call(this);\n  }\n}\nRC4Algo.keySize = 256 / 32;\nRC4Algo.ivSize = 0;\n\n/**\n * Shortcut functions to the cipher's object interface.\n *\n * @example\n *\n *     var ciphertext = CryptoJS.RC4.encrypt(message, key, cfg);\n *     var plaintext  = CryptoJS.RC4.decrypt(ciphertext, key, cfg);\n */\nexport const RC4 = StreamCipher._createHelper(RC4Algo);\n\n/**\n * Modified RC4 stream cipher algorithm.\n */\nexport class RC4DropAlgo extends RC4Algo {\n  constructor(...args) {\n    super(...args);\n\n    /**\n     * Configuration options.\n     *\n     * @property {number} drop The number of keystream words to drop. Default 192\n     */\n    Object.assign(this.cfg, { drop: 192 });\n  }\n\n  _doReset() {\n    super._doReset.call(this);\n\n    // Drop\n    for (let i = this.cfg.drop; i > 0; i -= 1) {\n      generateKeystreamWord.call(this);\n    }\n  }\n}\n\n/**\n * Shortcut functions to the cipher's object interface.\n *\n * @example\n *\n *     var ciphertext = CryptoJS.RC4Drop.encrypt(message, key, cfg);\n *     var plaintext  = CryptoJS.RC4Drop.decrypt(ciphertext, key, cfg);\n */\nexport const RC4Drop = StreamCipher._createHelper(RC4DropAlgo);\n"]},"metadata":{},"sourceType":"module"}